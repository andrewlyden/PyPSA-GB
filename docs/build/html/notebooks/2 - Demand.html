<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Demand &mdash; PyPSA-GB  documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Generator and Marginal Prices" href="3%20-%20Generator%20and%20Marginal%20Prices.html" />
    <link rel="prev" title="Network" href="1%20-%20Network.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> PyPSA-GB
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Data and Functionality</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="1%20-%20Network.html">Network</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Demand</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Historical-data---ESPENI">Historical data - ESPENI</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Future-data---FES2021">Future data - FES2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Peak-loads">Peak loads</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="3%20-%20Generator%20and%20Marginal%20Prices.html">Generator and Marginal Prices</a></li>
<li class="toctree-l1"><a class="reference internal" href="4%20-%20Renewable%20Power%20and%20Storage.html">Renewable Power and Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="5a%20-%20LOPF%20Historical.html">Historical Network Constrained Linear Optimal Power Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="5b%20-%20LOPF%20Future.html">Future Network Constrained Linear Optimal Power Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="6%20-%20Unit%20Commitment.html">Unit Commitment</a></li>
<li class="toctree-l1"><a class="reference internal" href="9%20-%20Comparison%20To%20Historical%20Data.html">Comparison To Historical Data</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="7%20-%20Network%20Expansion.html">Network Expansion</a></li>
<li class="toctree-l1"><a class="reference internal" href="5c%20-%20LOPF%20Future%20-%20Floating%20Wind%2C%20Marine%20and%20Emissions%20Modelling.html">Floating Wind &amp; Marine, and Emissions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyPSA-GB</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Demand</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/2 - Demand.nblink.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Demand">
<h1>Demand<a class="headerlink" href="#Demand" title="Permalink to this headline">¶</a></h1>
<p>PyPSA-GB uses the ESPENI (Elexon Sum Plus Embedded Net Imports) dataset from <a class="reference external" href="https://zenodo.org/record/3884859">https://zenodo.org/record/3884859</a>. This is a cleaned dataset using both National Grid and Elexon data to develop historical half hourly electricity profiles which represent the total system demand of the GB. Essentially, system view data (from Elexon) is added to embedded generation, i.e., distribution-connected solar and wind, and interconnector imports (both from National Grid). Therefore, generation at distribution
level and interconnectors should be added separately. This is available from 2008-11-06 up to 2021-06-06 (as of 2021-06-17). See <a class="reference external" href="https://doi.org/10.1016/j.esr.2021.100743">https://doi.org/10.1016/j.esr.2021.100743</a> for the paper Calculating Great Britain’s half-hourly electrical demand from publicly available data which describes the methodology for deriving this dataset.</p>
<p>Load distribution across buses from the Future Energy Scenario Regional Breakdown worksheet. Historical years use 2020 distribution for all timeperiods.</p>
<p>Future demand profiles are generated by scaling historical demand profiles according to FES data specific to different scenarios.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">find_dotenv</span><span class="p">,</span> <span class="n">load_dotenv</span>

<span class="n">load_dotenv</span><span class="p">(</span><span class="n">find_dotenv</span><span class="p">())</span>
<span class="n">src_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PROJECT_SRC&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">src_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span>

<span class="kn">import</span> <span class="nn">imageio</span>

<span class="kn">from</span> <span class="nn">scipy.spatial</span> <span class="kn">import</span> <span class="n">Voronoi</span><span class="p">,</span> <span class="n">voronoi_plot_2d</span>
<span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Polygon</span><span class="p">,</span> <span class="n">Point</span>

<span class="kn">from</span> <span class="nn">statistics</span> <span class="kn">import</span> <span class="n">mean</span>

<span class="kn">import</span> <span class="nn">loads</span>
</pre></div>
</div>
</div>
<div class="section" id="Historical-data---ESPENI">
<h2>Historical data - ESPENI<a class="headerlink" href="#Historical-data---ESPENI" title="Permalink to this headline">¶</a></h2>
<p>Historical load data is included in the form of the ESPENI dataset. This provides the load profile for the whole GB power system. National Grid’s FES2021 data includes a regional breakdown of projected demand by grid supply point which can be mapped to the nearest bus. The 2020 data for these regional breakdown is used to distribute the load across the buses for the historical years 2010-2020. The load distribution is plotted below for a three day period in December.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_network</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/network/buses.csv&#39;</span><span class="p">)[:</span><span class="mi">29</span><span class="p">]</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">df_network</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">df_network</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">coordinates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lon</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lon</span><span class="p">)):</span>
    <span class="n">coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">lat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="n">df_load</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;LOPF_data/loads-p_set.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">29</span><span class="p">]</span>
<span class="n">sizes</span> <span class="o">=</span> <span class="n">df_load</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">marker_scaler</span> <span class="o">=</span> <span class="mf">0.0001</span>

<span class="n">df_lines</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/network/lines.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df_buses</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/network/buses.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">line_coordinates</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_lines</span><span class="p">[</span><span class="s1">&#39;bus0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)):</span>

    <span class="n">bus0</span> <span class="o">=</span> <span class="n">df_lines</span><span class="p">[</span><span class="s1">&#39;bus0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">bus1</span> <span class="o">=</span> <span class="n">df_lines</span><span class="p">[</span><span class="s1">&#39;bus1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">bus0_coord</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_buses</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="n">bus0</span><span class="p">],</span> <span class="n">df_buses</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="n">bus0</span><span class="p">]]</span>
    <span class="n">bus1_coord</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_buses</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="n">bus1</span><span class="p">],</span> <span class="n">df_buses</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="n">bus1</span><span class="p">]]</span>
    <span class="n">line_coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">bus0_coord</span><span class="p">,</span> <span class="n">bus1_coord</span><span class="p">])</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                     <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cartopy</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cartopy</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">LAND</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_lines</span><span class="p">[</span><span class="s1">&#39;bus0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">line_coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">line_coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span>
            <span class="p">[</span><span class="n">line_coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">line_coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span>
            <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sizes</span> <span class="o">*</span> <span class="n">marker_scaler</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">sizes</span> <span class="o">*</span> <span class="n">marker_scaler</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">txt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df_buses</span><span class="p">[:</span><span class="mi">29</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="p">(</span><span class="n">lon</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lat</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset points&quot;</span><span class="p">,</span>
                <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;extra bold&#39;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Reduced Network GB with Load Distribution for 1-3 December&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
29
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;Reduced Network GB with Load Distribution for 1-3 December&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_2_-_Demand_6_2.png" src="../_images/notebooks_2_-_Demand_6_2.png" />
</div>
</div>
<p>The ESPENI dataset is plotted for the entire dataset, over 2020, and over 01/01/2020.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_loads</span> <span class="o">=</span> <span class="n">loads</span><span class="o">.</span><span class="n">read_historical_demand_data</span><span class="p">()</span>
<span class="n">df_loads</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;POWER_ESPENI_MW&#39;</span><span class="p">:</span> <span class="s1">&#39;load&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># add columns with year, month, and weekday name</span>
<span class="n">df_loads</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_loads</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span>
<span class="n">df_loads</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_loads</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot demand data</span>
<span class="n">df_loads</span><span class="p">[</span><span class="s1">&#39;load&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ESPENI demand over entire dataset&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Load [MW]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Load [MW]&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_2_-_Demand_9_1.png" src="../_images/notebooks_2_-_Demand_9_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot demand data</span>
<span class="n">df_loads</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2020&#39;</span><span class="p">,</span> <span class="s1">&#39;load&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ESPENI demand over 2020&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Load [MW]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Load [MW]&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_2_-_Demand_10_1.png" src="../_images/notebooks_2_-_Demand_10_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot demand data</span>
<span class="n">df_loads</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2020&#39;</span><span class="p">,</span> <span class="s1">&#39;load&#39;</span><span class="p">][</span><span class="s1">&#39;2020-01-01 00:00:00&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-01-01 23:30:00&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ESPENI demand over 01/01/2020&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Load [MW]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Load [MW]&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_2_-_Demand_11_1.png" src="../_images/notebooks_2_-_Demand_11_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Box plots over whole dataset for month values</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_loads</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;load&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Boxplot for months of ESPENI demand over whole dataset&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Supply [kWh]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Supply [kWh]&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_2_-_Demand_12_1.png" src="../_images/notebooks_2_-_Demand_12_1.png" />
</div>
</div>
</div>
<div class="section" id="Future-data---FES2021">
<h2>Future data - FES2021<a class="headerlink" href="#Future-data---FES2021" title="Permalink to this headline">¶</a></h2>
<p>Future demand profiles are generated by scaling historical demand profiles to match the projected annual load from the FES2021 dataset. Different demand profiles from historical years can be chosen, and this along with the use of weather data forms the baseline year used to simulate future years.</p>
<p>Distributions across buses are also obtained from FES2021 where data is available for distributions for the years 2020-2050 and all four scenarios.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="s1">&#39;2050-01-01 00:00:00&#39;</span>
<span class="n">end</span> <span class="o">=</span> <span class="s1">&#39;2050-12-31 23:30:00&#39;</span>
<span class="c1"># year of simulation</span>
<span class="n">year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
<span class="c1"># time step as fraction of hour</span>
<span class="n">time_step</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">year_baseline</span> <span class="o">=</span> <span class="mi">2019</span>

<span class="n">loads</span><span class="o">.</span><span class="n">write_loads</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
<span class="n">loads</span><span class="o">.</span><span class="n">write_loads_p_set</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">time_step</span><span class="p">,</span> <span class="n">year_baseline</span><span class="o">=</span><span class="n">year_baseline</span><span class="p">)</span>

<span class="n">df_loads</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;LOPF_data/loads-p_set.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df_loads</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Beauly</th>
      <th>Peterhead</th>
      <th>Errochty</th>
      <th>Denny/Bonnybridge</th>
      <th>Neilston</th>
      <th>Strathaven</th>
      <th>Torness</th>
      <th>Eccles</th>
      <th>Harker</th>
      <th>Stella West</th>
      <th>...</th>
      <th>Bramford</th>
      <th>Pelham</th>
      <th>Sundon/East Claydon</th>
      <th>Melksham</th>
      <th>Bramley</th>
      <th>London</th>
      <th>Kemsley</th>
      <th>Sellindge</th>
      <th>Lovedean</th>
      <th>S.W.Penisula</th>
    </tr>
    <tr>
      <th>name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2050-01-01 00:00:00</th>
      <td>344.355716</td>
      <td>558.886240</td>
      <td>193.947235</td>
      <td>1686.965699</td>
      <td>1996.760548</td>
      <td>604.448906</td>
      <td>526.317230</td>
      <td>148.145454</td>
      <td>518.410526</td>
      <td>3079.460303</td>
      <td>...</td>
      <td>1688.300283</td>
      <td>1069.606749</td>
      <td>3497.217334</td>
      <td>4568.503846</td>
      <td>1573.208859</td>
      <td>10496.610559</td>
      <td>1762.364772</td>
      <td>1054.263148</td>
      <td>2623.240880</td>
      <td>3460.358091</td>
    </tr>
    <tr>
      <th>2050-01-01 00:30:00</th>
      <td>338.171563</td>
      <td>548.849415</td>
      <td>190.464211</td>
      <td>1656.670125</td>
      <td>1960.901487</td>
      <td>593.593838</td>
      <td>516.865300</td>
      <td>145.484966</td>
      <td>509.100589</td>
      <td>3024.157449</td>
      <td>...</td>
      <td>1657.980742</td>
      <td>1050.398089</td>
      <td>3434.412141</td>
      <td>4486.459828</td>
      <td>1544.956201</td>
      <td>10308.105933</td>
      <td>1730.715135</td>
      <td>1035.330038</td>
      <td>2576.131097</td>
      <td>3398.214840</td>
    </tr>
    <tr>
      <th>2050-01-01 01:00:00</th>
      <td>340.002975</td>
      <td>551.821781</td>
      <td>191.495695</td>
      <td>1665.642039</td>
      <td>1971.521006</td>
      <td>596.808524</td>
      <td>519.664452</td>
      <td>146.272859</td>
      <td>511.857690</td>
      <td>3040.535171</td>
      <td>...</td>
      <td>1666.959754</td>
      <td>1056.086657</td>
      <td>3453.011651</td>
      <td>4510.756839</td>
      <td>1553.323114</td>
      <td>10363.930832</td>
      <td>1740.088049</td>
      <td>1040.937003</td>
      <td>2590.082473</td>
      <td>3416.618318</td>
    </tr>
    <tr>
      <th>2050-01-01 01:30:00</th>
      <td>344.619138</td>
      <td>559.313772</td>
      <td>194.095599</td>
      <td>1688.256179</td>
      <td>1998.288013</td>
      <td>604.911292</td>
      <td>526.719848</td>
      <td>148.258781</td>
      <td>518.807096</td>
      <td>3081.816002</td>
      <td>...</td>
      <td>1689.591785</td>
      <td>1070.424967</td>
      <td>3499.892606</td>
      <td>4571.998622</td>
      <td>1574.412319</td>
      <td>10504.640168</td>
      <td>1763.712931</td>
      <td>1055.069629</td>
      <td>2625.247585</td>
      <td>3463.005167</td>
    </tr>
    <tr>
      <th>2050-01-01 02:00:00</th>
      <td>340.329117</td>
      <td>552.351106</td>
      <td>191.679384</td>
      <td>1667.239777</td>
      <td>1973.412153</td>
      <td>597.381002</td>
      <td>520.162931</td>
      <td>146.413169</td>
      <td>512.348681</td>
      <td>3043.451751</td>
      <td>...</td>
      <td>1668.558756</td>
      <td>1057.099690</td>
      <td>3456.323892</td>
      <td>4515.083704</td>
      <td>1554.813112</td>
      <td>10373.872253</td>
      <td>1741.757199</td>
      <td>1041.935504</td>
      <td>2592.566964</td>
      <td>3419.895650</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2050-12-31 21:30:00</th>
      <td>426.330239</td>
      <td>691.930155</td>
      <td>240.116738</td>
      <td>2088.551042</td>
      <td>2472.093135</td>
      <td>748.339100</td>
      <td>651.608032</td>
      <td>183.411756</td>
      <td>641.819123</td>
      <td>3812.531593</td>
      <td>...</td>
      <td>2090.203326</td>
      <td>1324.228638</td>
      <td>4329.736468</td>
      <td>5656.044741</td>
      <td>1947.714173</td>
      <td>12995.348356</td>
      <td>2181.899005</td>
      <td>1305.232464</td>
      <td>3247.708283</td>
      <td>4284.102814</td>
    </tr>
    <tr>
      <th>2050-12-31 22:00:00</th>
      <td>412.130520</td>
      <td>668.884140</td>
      <td>232.119205</td>
      <td>2018.987980</td>
      <td>2389.755494</td>
      <td>723.414280</td>
      <td>629.905020</td>
      <td>177.302888</td>
      <td>620.442148</td>
      <td>3685.548166</td>
      <td>...</td>
      <td>2020.585232</td>
      <td>1280.122750</td>
      <td>4185.526574</td>
      <td>5467.659692</td>
      <td>1882.841944</td>
      <td>12562.514204</td>
      <td>2109.226817</td>
      <td>1261.759279</td>
      <td>3139.537342</td>
      <td>4141.412833</td>
    </tr>
    <tr>
      <th>2050-12-31 22:30:00</th>
      <td>393.879115</td>
      <td>639.262273</td>
      <td>221.839691</td>
      <td>1929.576094</td>
      <td>2283.923984</td>
      <td>691.377519</td>
      <td>602.009363</td>
      <td>169.450941</td>
      <td>592.965559</td>
      <td>3522.331834</td>
      <td>...</td>
      <td>1931.102611</td>
      <td>1223.431878</td>
      <td>4000.168450</td>
      <td>5225.521666</td>
      <td>1799.459353</td>
      <td>12006.177020</td>
      <td>2015.818659</td>
      <td>1205.881642</td>
      <td>3000.501371</td>
      <td>3958.008308</td>
    </tr>
    <tr>
      <th>2050-12-31 23:00:00</th>
      <td>380.983965</td>
      <td>618.333559</td>
      <td>214.576914</td>
      <td>1866.403985</td>
      <td>2209.150932</td>
      <td>668.742611</td>
      <td>582.300267</td>
      <td>163.903312</td>
      <td>573.552547</td>
      <td>3407.014728</td>
      <td>...</td>
      <td>1867.880526</td>
      <td>1183.378121</td>
      <td>3869.207521</td>
      <td>5054.444078</td>
      <td>1740.547117</td>
      <td>11613.108550</td>
      <td>1949.823067</td>
      <td>1166.402460</td>
      <td>2902.268396</td>
      <td>3828.427654</td>
    </tr>
    <tr>
      <th>2050-12-31 23:30:00</th>
      <td>370.735581</td>
      <td>601.700525</td>
      <td>208.804843</td>
      <td>1816.198136</td>
      <td>2149.725266</td>
      <td>650.753585</td>
      <td>566.636520</td>
      <td>159.494350</td>
      <td>558.124111</td>
      <td>3315.366795</td>
      <td>...</td>
      <td>1817.634958</td>
      <td>1151.545514</td>
      <td>3765.126705</td>
      <td>4918.480664</td>
      <td>1693.726789</td>
      <td>11300.718530</td>
      <td>1897.373263</td>
      <td>1135.026495</td>
      <td>2824.198026</td>
      <td>3725.443807</td>
    </tr>
  </tbody>
</table>
<p>17520 rows × 29 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_loads</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ESPENI demand over 2050&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Load [MW]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Load [MW]&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_2_-_Demand_16_1.png" src="../_images/notebooks_2_-_Demand_16_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_loads</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_loads</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_loads</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
name
2050-01-01 00:00:00    64741.136363
2050-01-01 00:30:00    63578.474982
2050-01-01 01:00:00    63922.792551
2050-01-01 01:30:00    64790.661493
2050-01-01 02:00:00    63984.109379
                           ...
2050-12-31 21:30:00    80152.885093
2050-12-31 22:00:00    77483.244762
2050-12-31 22:30:00    74051.860768
2050-12-31 23:00:00    71627.487747
2050-12-31 23:30:00    69700.724363
Name: Total, Length: 17520, dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_loads</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ESPENI demand over 2050 with 2019 baseline&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Load [MW]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Load [MW]&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_2_-_Demand_18_1.png" src="../_images/notebooks_2_-_Demand_18_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_FES</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span>
            <span class="s1">&#39;../data/FES2021/FES 2021 Data Workbook V04.xlsx&#39;</span><span class="p">,</span>
            <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;ED1&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="n">df_FES_demand</span> <span class="o">=</span> <span class="n">df_FES</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_FES</span><span class="p">[</span><span class="s1">&#39;Data item&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;GBFES System Demand: Total&#39;</span><span class="p">]</span>
<span class="n">scenario</span> <span class="o">=</span> <span class="s1">&#39;Leading the Way&#39;</span>
<span class="n">df_FES_demand</span> <span class="o">=</span> <span class="n">df_FES_demand</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_FES_demand</span><span class="p">[</span><span class="s1">&#39;Scenario&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">scenario</span><span class="p">]</span>
<span class="n">date</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-01-01 00:00:00&#39;</span>
<span class="n">df_FES_demand</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df_FES_demand</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="c1"># future demand in GWh/yr</span>
<span class="n">future_demand</span> <span class="o">=</span> <span class="n">df_FES_demand</span><span class="p">[</span><span class="n">date</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">future_demand</span> <span class="o">+</span> <span class="s1">&#39; GWh/year&#39;</span> <span class="o">+</span> <span class="s1">&#39; future total system demand in &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; from FES2021 workbook&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
686266 GWh/year future total system demand in 2050 from FES2021 workbook
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">df_loads</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; GWh/year&#39;</span> <span class="o">+</span> <span class="s1">&#39; future total system demand in &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; from checking dataframe by summing&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
686266.0 GWh/year future total system demand in 2050 from checking dataframe by summing
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_loads</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Beauly</th>
      <th>Peterhead</th>
      <th>Errochty</th>
      <th>Denny/Bonnybridge</th>
      <th>Neilston</th>
      <th>Strathaven</th>
      <th>Torness</th>
      <th>Eccles</th>
      <th>Harker</th>
      <th>Stella West</th>
      <th>...</th>
      <th>Pelham</th>
      <th>Sundon/East Claydon</th>
      <th>Melksham</th>
      <th>Bramley</th>
      <th>London</th>
      <th>Kemsley</th>
      <th>Sellindge</th>
      <th>Lovedean</th>
      <th>S.W.Penisula</th>
      <th>Total</th>
    </tr>
    <tr>
      <th>name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2050-01-01 00:00:00</th>
      <td>344.355716</td>
      <td>558.886240</td>
      <td>193.947235</td>
      <td>1686.965699</td>
      <td>1996.760548</td>
      <td>604.448906</td>
      <td>526.317230</td>
      <td>148.145454</td>
      <td>518.410526</td>
      <td>3079.460303</td>
      <td>...</td>
      <td>1069.606749</td>
      <td>3497.217334</td>
      <td>4568.503846</td>
      <td>1573.208859</td>
      <td>10496.610559</td>
      <td>1762.364772</td>
      <td>1054.263148</td>
      <td>2623.240880</td>
      <td>3460.358091</td>
      <td>64741.136363</td>
    </tr>
    <tr>
      <th>2050-01-01 00:30:00</th>
      <td>338.171563</td>
      <td>548.849415</td>
      <td>190.464211</td>
      <td>1656.670125</td>
      <td>1960.901487</td>
      <td>593.593838</td>
      <td>516.865300</td>
      <td>145.484966</td>
      <td>509.100589</td>
      <td>3024.157449</td>
      <td>...</td>
      <td>1050.398089</td>
      <td>3434.412141</td>
      <td>4486.459828</td>
      <td>1544.956201</td>
      <td>10308.105933</td>
      <td>1730.715135</td>
      <td>1035.330038</td>
      <td>2576.131097</td>
      <td>3398.214840</td>
      <td>63578.474982</td>
    </tr>
    <tr>
      <th>2050-01-01 01:00:00</th>
      <td>340.002975</td>
      <td>551.821781</td>
      <td>191.495695</td>
      <td>1665.642039</td>
      <td>1971.521006</td>
      <td>596.808524</td>
      <td>519.664452</td>
      <td>146.272859</td>
      <td>511.857690</td>
      <td>3040.535171</td>
      <td>...</td>
      <td>1056.086657</td>
      <td>3453.011651</td>
      <td>4510.756839</td>
      <td>1553.323114</td>
      <td>10363.930832</td>
      <td>1740.088049</td>
      <td>1040.937003</td>
      <td>2590.082473</td>
      <td>3416.618318</td>
      <td>63922.792551</td>
    </tr>
    <tr>
      <th>2050-01-01 01:30:00</th>
      <td>344.619138</td>
      <td>559.313772</td>
      <td>194.095599</td>
      <td>1688.256179</td>
      <td>1998.288013</td>
      <td>604.911292</td>
      <td>526.719848</td>
      <td>148.258781</td>
      <td>518.807096</td>
      <td>3081.816002</td>
      <td>...</td>
      <td>1070.424967</td>
      <td>3499.892606</td>
      <td>4571.998622</td>
      <td>1574.412319</td>
      <td>10504.640168</td>
      <td>1763.712931</td>
      <td>1055.069629</td>
      <td>2625.247585</td>
      <td>3463.005167</td>
      <td>64790.661493</td>
    </tr>
    <tr>
      <th>2050-01-01 02:00:00</th>
      <td>340.329117</td>
      <td>552.351106</td>
      <td>191.679384</td>
      <td>1667.239777</td>
      <td>1973.412153</td>
      <td>597.381002</td>
      <td>520.162931</td>
      <td>146.413169</td>
      <td>512.348681</td>
      <td>3043.451751</td>
      <td>...</td>
      <td>1057.099690</td>
      <td>3456.323892</td>
      <td>4515.083704</td>
      <td>1554.813112</td>
      <td>10373.872253</td>
      <td>1741.757199</td>
      <td>1041.935504</td>
      <td>2592.566964</td>
      <td>3419.895650</td>
      <td>63984.109379</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2050-12-31 21:30:00</th>
      <td>426.330239</td>
      <td>691.930155</td>
      <td>240.116738</td>
      <td>2088.551042</td>
      <td>2472.093135</td>
      <td>748.339100</td>
      <td>651.608032</td>
      <td>183.411756</td>
      <td>641.819123</td>
      <td>3812.531593</td>
      <td>...</td>
      <td>1324.228638</td>
      <td>4329.736468</td>
      <td>5656.044741</td>
      <td>1947.714173</td>
      <td>12995.348356</td>
      <td>2181.899005</td>
      <td>1305.232464</td>
      <td>3247.708283</td>
      <td>4284.102814</td>
      <td>80152.885093</td>
    </tr>
    <tr>
      <th>2050-12-31 22:00:00</th>
      <td>412.130520</td>
      <td>668.884140</td>
      <td>232.119205</td>
      <td>2018.987980</td>
      <td>2389.755494</td>
      <td>723.414280</td>
      <td>629.905020</td>
      <td>177.302888</td>
      <td>620.442148</td>
      <td>3685.548166</td>
      <td>...</td>
      <td>1280.122750</td>
      <td>4185.526574</td>
      <td>5467.659692</td>
      <td>1882.841944</td>
      <td>12562.514204</td>
      <td>2109.226817</td>
      <td>1261.759279</td>
      <td>3139.537342</td>
      <td>4141.412833</td>
      <td>77483.244762</td>
    </tr>
    <tr>
      <th>2050-12-31 22:30:00</th>
      <td>393.879115</td>
      <td>639.262273</td>
      <td>221.839691</td>
      <td>1929.576094</td>
      <td>2283.923984</td>
      <td>691.377519</td>
      <td>602.009363</td>
      <td>169.450941</td>
      <td>592.965559</td>
      <td>3522.331834</td>
      <td>...</td>
      <td>1223.431878</td>
      <td>4000.168450</td>
      <td>5225.521666</td>
      <td>1799.459353</td>
      <td>12006.177020</td>
      <td>2015.818659</td>
      <td>1205.881642</td>
      <td>3000.501371</td>
      <td>3958.008308</td>
      <td>74051.860768</td>
    </tr>
    <tr>
      <th>2050-12-31 23:00:00</th>
      <td>380.983965</td>
      <td>618.333559</td>
      <td>214.576914</td>
      <td>1866.403985</td>
      <td>2209.150932</td>
      <td>668.742611</td>
      <td>582.300267</td>
      <td>163.903312</td>
      <td>573.552547</td>
      <td>3407.014728</td>
      <td>...</td>
      <td>1183.378121</td>
      <td>3869.207521</td>
      <td>5054.444078</td>
      <td>1740.547117</td>
      <td>11613.108550</td>
      <td>1949.823067</td>
      <td>1166.402460</td>
      <td>2902.268396</td>
      <td>3828.427654</td>
      <td>71627.487747</td>
    </tr>
    <tr>
      <th>2050-12-31 23:30:00</th>
      <td>370.735581</td>
      <td>601.700525</td>
      <td>208.804843</td>
      <td>1816.198136</td>
      <td>2149.725266</td>
      <td>650.753585</td>
      <td>566.636520</td>
      <td>159.494350</td>
      <td>558.124111</td>
      <td>3315.366795</td>
      <td>...</td>
      <td>1151.545514</td>
      <td>3765.126705</td>
      <td>4918.480664</td>
      <td>1693.726789</td>
      <td>11300.718530</td>
      <td>1897.373263</td>
      <td>1135.026495</td>
      <td>2824.198026</td>
      <td>3725.443807</td>
      <td>69700.724363</td>
    </tr>
  </tbody>
</table>
<p>17520 rows × 30 columns</p>
</div></div>
</div>
</div>
<div class="section" id="Peak-loads">
<h2>Peak loads<a class="headerlink" href="#Peak-loads" title="Permalink to this headline">¶</a></h2>
<p>Scaling the load profile according to the annual energy demand to generate future load profiles results in overestimation of peak demands.</p>
<p>The analysis below shows the FES2021 data peak to be 94.7 GW, but the generated future load profile have a peak of 115.8 GW. Applying a moving average can reduce the peak demand to 99.2 GW. A smoothing algorithm is not currently applied.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Leading the way, 2050 Electricity System ACS (Average Cold Spell) Peak Demand GW</span>
<span class="n">peak_FES</span> <span class="o">=</span> <span class="mf">94.7</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_loads</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Beauly                         615.806163
Peterhead                      999.447883
Errochty                       346.832933
Denny/Bonnybridge             3016.775465
Neilston                      3570.776950
Strathaven                    1080.926916
Torness                        941.205211
Eccles                         264.926294
Harker                         927.065772
Stella West                   5506.952687
Penwortham                    3082.161410
Deeside                       6189.332211
Daines                        6235.934595
Th. Marsh/Stocksbridge        5289.028020
Thornton/Drax/Eggborough      4514.522126
Keadby                        1650.378196
Ratcliffe                     4251.839548
Feckenham                     8409.920397
Walpole                       2025.619240
Bramford                      3019.162082
Pelham                        1912.761711
Sundon/East Claydon           6254.021323
Melksham                      8169.786931
Bramley                       2813.345814
London                       18770.931283
Kemsley                       3151.610497
Sellindge                     1885.322980
Lovedean                      4691.102334
S.W.Penisula                  6188.106492
Total                       115775.603466
dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_loads_smoothed</span> <span class="o">=</span> <span class="n">df_loads</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">48</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">df_loads_smoothed</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Beauly                        528.027202
Peterhead                     856.983416
Errochty                      297.394268
Denny/Bonnybridge            2586.754736
Neilston                     3061.787094
Strathaven                    926.848170
Torness                       807.042840
Eccles                        227.162861
Harker                        794.918880
Stella West                  4721.974209
Penwortham                   2642.820361
Deeside                      5307.085195
Daines                       5347.044727
Th. Marsh/Stocksbridge       4535.113215
Thornton/Drax/Eggborough     3871.007844
Keadby                       1415.128061
Ratcliffe                    3645.768872
Feckenham                    7211.143707
Walpole                      1736.881058
Bramford                     2588.801157
Pelham                       1640.110599
Sundon/East Claydon          5362.553315
Melksham                     7005.239626
Bramley                      2412.322591
London                      16095.263285
Kemsley                      2702.369955
Sellindge                    1616.583071
Lovedean                     4022.417749
S.W.Penisula                 5306.034193
Total                       99272.582257
dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_loads</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">df_loads_smoothed</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Demand and Smoothed Demand&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Load [MW]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Load [MW]&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_2_-_Demand_27_1.png" src="../_images/notebooks_2_-_Demand_27_1.png" />
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="1%20-%20Network.html" class="btn btn-neutral float-left" title="Network" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="3%20-%20Generator%20and%20Marginal%20Prices.html" class="btn btn-neutral float-right" title="Generator and Marginal Prices" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Andrew Lyden.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
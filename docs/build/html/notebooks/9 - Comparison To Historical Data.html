
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Comparison To Historical Data &#8212; PyPSA-GB 0.1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=9d21ab04" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=01f34227"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/9 - Comparison To Historical Data';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">PyPSA-GB</p>
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/quickstart.html">
    Quickstart: Run Your First Model
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/first_scenario.html">
    Your First Custom Scenario
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../user_guide/index.html">
    User Guide
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../user_guide/workflow.html">
    Snakemake Workflow
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../user_guide/configuration.html">
    Configuration Reference
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../user_guide/scenarios.html">
    Scenario Design
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../user_guide/network_models.html">
    Network Models
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../user_guide/clustering.html">
    Network Clustering
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../data_reference/index.html">
    Data Reference
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../data_reference/data_sources.html">
    Data Sources
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../data_reference/network_data.html">
    Network Data
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../data_reference/maintenance.html">
    Data Maintenance
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../tutorials/index.html">
    Tutorials
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="1%20-%20Network.html">
    Network
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="2%20-%20Demand.html">
    Demand
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="3%20-%20Generator%20and%20Marginal%20Prices.html">
    Generator and Marginal Prices
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="4%20-%20Renewable%20Power%20and%20Storage.html">
    Renewable Power and Storage
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="5a%20-%20Historical%20Years.html">
    Historical Years
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="5b%20-%20Future%20Years.html">
    Future Years
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../api/index.html">
    API Reference
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../api/core_modules.html">
    Core Modules
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../api/integration_modules.html">
    Integration Modules
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../development/contributing.html">
    Contributing
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../development/architecture.html">
    Architecture
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../development/release_notes.html">
    Release Notes
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../development/troubleshooting.html">
    Troubleshooting
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/quickstart.html">
    Quickstart: Run Your First Model
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/first_scenario.html">
    Your First Custom Scenario
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/workflow.html">
    Snakemake Workflow
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/configuration.html">
    Configuration Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/scenarios.html">
    Scenario Design
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/network_models.html">
    Network Models
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/clustering.html">
    Network Clustering
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../data_reference/index.html">
    Data Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../data_reference/data_sources.html">
    Data Sources
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../data_reference/network_data.html">
    Network Data
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../data_reference/maintenance.html">
    Data Maintenance
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tutorials/index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="1%20-%20Network.html">
    Network
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="2%20-%20Demand.html">
    Demand
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="3%20-%20Generator%20and%20Marginal%20Prices.html">
    Generator and Marginal Prices
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="4%20-%20Renewable%20Power%20and%20Storage.html">
    Renewable Power and Storage
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="5a%20-%20Historical%20Years.html">
    Historical Years
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="5b%20-%20Future%20Years.html">
    Future Years
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/core_modules.html">
    Core Modules
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/integration_modules.html">
    Integration Modules
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../development/contributing.html">
    Contributing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../development/architecture.html">
    Architecture
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../development/release_notes.html">
    Release Notes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../development/troubleshooting.html">
    Troubleshooting
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<h3><a href="../index.html">Table of Contents</a></h3>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/quickstart.html">Quickstart: Run Your First Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/first_scenario.html">Your First Custom Scenario</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/workflow.html">Snakemake Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/configuration.html">Configuration Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/scenarios.html">Scenario Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/network_models.html">Network Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/clustering.html">Network Clustering</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../data_reference/index.html">Data Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_reference/data_sources.html">Data Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_reference/network_data.html">Network Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_reference/maintenance.html">Data Maintenance</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="1%20-%20Network.html">Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="1%20-%20Network.html#Zonal-model">Zonal model</a></li>
<li class="toctree-l1"><a class="reference internal" href="2%20-%20Demand.html">Demand</a></li>
<li class="toctree-l1"><a class="reference internal" href="3%20-%20Generator%20and%20Marginal%20Prices.html">Generator and Marginal Prices</a></li>
<li class="toctree-l1"><a class="reference internal" href="4%20-%20Renewable%20Power%20and%20Storage.html">Renewable Power and Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="5a%20-%20Historical%20Years.html">Historical Years</a></li>
<li class="toctree-l1"><a class="reference internal" href="5b%20-%20Future%20Years.html">Future Years</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/core_modules.html">Core Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/integration_modules.html">Integration Modules</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/troubleshooting.html">Troubleshooting</a></li>
</ul>
</div>
        <div class="sidebar-primary-item">
<div id="searchbox"></div></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Comparison...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="Comparison-To-Historical-Data">
<h1>Comparison To Historical Data<a class="headerlink" href="#Comparison-To-Historical-Data" title="Link to this heading">#</a></h1>
<p>This notebook simulates 2018 using the network constrained LOPF functionality and compares the generation output to historical data published by BEIS.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">find_dotenv</span><span class="p">,</span> <span class="n">load_dotenv</span>

<span class="n">load_dotenv</span><span class="p">(</span><span class="n">find_dotenv</span><span class="p">())</span>
<span class="n">src_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PROJECT_SRC&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">src_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pypsa</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>

<span class="kn">import</span> <span class="nn">data_reader_writer</span>
</pre></div>
</div>
</div>
<section id="Setting-up-simulation">
<h2>Setting up simulation<a class="headerlink" href="#Setting-up-simulation" title="Link to this heading">#</a></h2>
<p>Set the required inputs for the LOPF: the start, end and year of simulation, and the timestep.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># write csv files for import</span>
<span class="n">start</span> <span class="o">=</span> <span class="s1">&#39;2018-01-01 00:00:00&#39;</span>
<span class="n">end</span> <span class="o">=</span> <span class="s1">&#39;2018-12-31 23:00:00&#39;</span>
<span class="c1"># year of simulation</span>
<span class="n">year</span> <span class="o">=</span> <span class="mi">2018</span>
<span class="c1"># time step as fraction of hour</span>
<span class="n">time_step</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<p>data_reader_writer is a script written to read in data from the various sources and write csv files in the format required for populating a PyPSA network object</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_reader_writer</span><span class="o">.</span><span class="n">data_writer</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">time_step</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">demand_dataset</span><span class="o">=</span><span class="s1">&#39;historical&#39;</span><span class="p">,</span> <span class="n">merge_generators</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\Users\alyden\Anaconda3\envs\PyPSA-GB\lib\site-packages\pandas\core\indexing.py:1667: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self.obj[key] = value
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                     BritNed  EastWest  Moyle  Nemo   IFA  IFA2
2018-01-01 00:00:00      836       432    178   0.0  1701  -1.0
2018-01-01 00:30:00      859       432    187   0.0  1702  -1.0
2018-01-01 01:00:00      715       432    205   0.0  1415  -1.0
2018-01-01 01:30:00      709       432    201   0.0  1404  -1.0
2018-01-01 02:00:00      720       432    211   0.0  1405  -1.0
...                      ...       ...    ...   ...   ...   ...
2018-12-31 21:00:00      716      -535   -454   0.0  1998  -1.0
2018-12-31 21:30:00      716      -536   -439   0.0  1998  -1.0
2018-12-31 22:00:00      862      -536   -424   0.0  1949  -1.0
2018-12-31 22:30:00      777      -535   -454   0.0  1960  -1.0
2018-12-31 23:00:00     -268      -536   -455   0.0  1182  -1.0

[17519 rows x 6 columns]
                     Hywind Scotland Pilot Park (Hywind 2) Demonstrator  \
name
2018-01-01 00:00:00                                           0.628330
2018-01-01 01:00:00                                           0.496963
2018-01-01 02:00:00                                           0.420427
2018-01-01 03:00:00                                           0.366537
2018-01-01 04:00:00                                           0.283425
...                                                                ...
2018-12-31 19:00:00                                           1.000000
2018-12-31 20:00:00                                           1.000000
2018-12-31 21:00:00                                           1.000000
2018-12-31 22:00:00                                           1.000000
2018-12-31 23:00:00                                           1.000000

                     Beatrice Demonstrator  Burbo Bank  \
name
2018-01-01 00:00:00               0.389669    1.000000
2018-01-01 01:00:00               0.239299    0.998580
2018-01-01 02:00:00               0.157686    0.999683
2018-01-01 03:00:00               0.214419    1.000000
2018-01-01 04:00:00               0.226166    1.000000
...                                    ...         ...
2018-12-31 19:00:00               1.000000    0.883318
2018-12-31 20:00:00               1.000000    0.960598
2018-12-31 21:00:00               1.000000    0.989805
2018-12-31 22:00:00               1.000000    0.997785
2018-12-31 23:00:00               1.000000    0.997781

                     Gunfleet Sands - (Demo) Extension  Gunfleet Sands II  \
name
2018-01-01 00:00:00                           1.000000           1.000000
2018-01-01 01:00:00                           1.000000           1.000000
2018-01-01 02:00:00                           1.000000           1.000000
2018-01-01 03:00:00                           1.000000           1.000000
2018-01-01 04:00:00                           1.000000           1.000000
...                                                ...                ...
2018-12-31 19:00:00                           0.176646           0.219137
2018-12-31 20:00:00                           0.236145           0.305543
2018-12-31 21:00:00                           0.324958           0.413130
2018-12-31 22:00:00                           0.336531           0.427215
2018-12-31 23:00:00                           0.333989           0.424122

                     Gunfleet Sands Offshore Wind Scheme  Inner Dowsing  \
name
2018-01-01 00:00:00                             1.000000       1.000000
2018-01-01 01:00:00                             1.000000       1.000000
2018-01-01 02:00:00                             1.000000       1.000000
2018-01-01 03:00:00                             1.000000       0.999176
2018-01-01 04:00:00                             1.000000       0.999927
...                                                  ...            ...
2018-12-31 19:00:00                             0.219137       0.725876
2018-12-31 20:00:00                             0.305543       0.841656
2018-12-31 21:00:00                             0.413130       0.945800
2018-12-31 22:00:00                             0.427215       0.988690
2018-12-31 23:00:00                             0.424122       0.988702

                     Kentish Flats      Lynn  North Hoyle  ...  \
name                                                       ...
2018-01-01 00:00:00       1.000000  1.000000     1.000000  ...
2018-01-01 01:00:00       1.000000  1.000000     1.000000  ...
2018-01-01 02:00:00       1.000000  1.000000     1.000000  ...
2018-01-01 03:00:00       1.000000  0.999176     1.000000  ...
2018-01-01 04:00:00       0.999294  0.999927     1.000000  ...
...                            ...       ...          ...  ...
2018-12-31 19:00:00       0.138550  0.725876     0.883686  ...
2018-12-31 20:00:00       0.197593  0.841656     0.971250  ...
2018-12-31 21:00:00       0.312961  0.945800     0.990698  ...
2018-12-31 22:00:00       0.298964  0.988690     0.997514  ...
2018-12-31 23:00:00       0.303321  0.988702     0.997491  ...

                     Abhainn Gleann Nam Fiadh  Allt Cheanna Mhuir Hydro  \
name
2018-01-01 00:00:00                  0.188146                  0.188146
2018-01-01 01:00:00                  0.185481                  0.185481
2018-01-01 02:00:00                  0.176687                  0.176687
2018-01-01 03:00:00                  0.149238                  0.149238
2018-01-01 04:00:00                  0.144974                  0.144974
...                                       ...                       ...
2018-12-31 19:00:00                  0.236382                  0.236382
2018-12-31 20:00:00                  0.225189                  0.225189
2018-12-31 21:00:00                  0.221192                  0.221192
2018-12-31 22:00:00                  0.216128                  0.216128
2018-12-31 23:00:00                  0.228121                  0.228121

                     Keltneyburn Hydro  Ceannacroc.1  \
name
2018-01-01 00:00:00           0.188146      0.188146
2018-01-01 01:00:00           0.185481      0.185481
2018-01-01 02:00:00           0.176687      0.176687
2018-01-01 03:00:00           0.149238      0.149238
2018-01-01 04:00:00           0.144974      0.144974
...                                ...           ...
2018-12-31 19:00:00           0.236382      0.236382
2018-12-31 20:00:00           0.225189      0.225189
2018-12-31 21:00:00           0.221192      0.221192
2018-12-31 22:00:00           0.216128      0.216128
2018-12-31 23:00:00           0.228121      0.228121

                     Bruach Caorainn Hydro Scheme  Llyn Celyn  Caban Coch  \
name
2018-01-01 00:00:00                      0.188146    0.188146    0.188146
2018-01-01 01:00:00                      0.185481    0.185481    0.185481
2018-01-01 02:00:00                      0.176687    0.176687    0.176687
2018-01-01 03:00:00                      0.149238    0.149238    0.149238
2018-01-01 04:00:00                      0.144974    0.144974    0.144974
...                                           ...         ...         ...
2018-12-31 19:00:00                      0.236382    0.236382    0.236382
2018-12-31 20:00:00                      0.225189    0.225189    0.225189
2018-12-31 21:00:00                      0.221192    0.221192    0.221192
2018-12-31 22:00:00                      0.216128    0.216128    0.216128
2018-12-31 23:00:00                      0.228121    0.228121    0.228121

                     River Coiltie Hydro Scheme  Eas a Ghaill  \
name
2018-01-01 00:00:00                    0.188146      0.188146
2018-01-01 01:00:00                    0.185481      0.185481
2018-01-01 02:00:00                    0.176687      0.176687
2018-01-01 03:00:00                    0.149238      0.149238
2018-01-01 04:00:00                    0.144974      0.144974
...                                         ...           ...
2018-12-31 19:00:00                    0.236382      0.236382
2018-12-31 20:00:00                    0.225189      0.225189
2018-12-31 21:00:00                    0.221192      0.221192
2018-12-31 22:00:00                    0.216128      0.216128
2018-12-31 23:00:00                    0.228121      0.228121

                     River Pattack (resubmission)
name
2018-01-01 00:00:00                      0.188146
2018-01-01 01:00:00                      0.185481
2018-01-01 02:00:00                      0.176687
2018-01-01 03:00:00                      0.149238
2018-01-01 04:00:00                      0.144974
...                                           ...
2018-12-31 19:00:00                      0.236382
2018-12-31 20:00:00                      0.225189
2018-12-31 21:00:00                      0.221192
2018-12-31 22:00:00                      0.216128
2018-12-31 23:00:00                      0.228121

[8760 rows x 1994 columns]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span> <span class="o">=</span> <span class="n">pypsa</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span>

<span class="n">network</span><span class="o">.</span><span class="n">import_from_csv_folder</span><span class="p">(</span><span class="s1">&#39;LOPF_data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING:pypsa.io:
Importing PyPSA from older version of PyPSA than current version.
Please read the release notes at https://pypsa.readthedocs.io/en/latest/release_notes.html
carefully to prepare your network for import.
Currently used PyPSA version [0, 20, 1], imported network file PyPSA version None.

INFO:pypsa.components:Applying weightings to all columns of `snapshot_weightings`
INFO:pypsa.io:Imported network LOPF_data has buses, generators, lines, loads, storage_units
</pre></div></div>
</div>
<p>To approximate n-1 security and allow room for reactive power flows, donâ€™t allow any line to be loaded above 70% of their thermal rating</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">contingency_factor</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">network</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">s_max_pu</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">99</span><span class="p">]</span> <span class="o">*=</span> <span class="n">contingency_factor</span>
</pre></div>
</div>
</div>
<p>LOPF does not account for losses through lines. Here we add a 10% margin to the load in order to account for these losses.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">loads_t</span><span class="o">.</span><span class="n">p_set</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">29</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">1.1</span>
</pre></div>
</div>
</div>
</section>
<section id="Running-the-optimisation">
<h2>Running the optimisation<a class="headerlink" href="#Running-the-optimisation" title="Link to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">lopf</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;gurobi&quot;</span><span class="p">,</span> <span class="n">pyomo</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING:pypsa.components:Warning, sub network 0 contains buses with mixed carriers! Value counts:
AC    29
DC     6
Name: carrier, dtype: int64
INFO:pypsa.linopf:Prepare linear problem
WARNING:pypsa.components:Warning, sub network 0 contains buses with mixed carriers! Value counts:
AC    29
DC     6
Name: carrier, dtype: int64
INFO:pypsa.linopf:Total preparation time: 94.07s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Set parameter Username
Academic license - for non-commercial use only - expires 2023-10-19
Read LP format model from file C:\Users\alyden\AppData\Local\Temp\pypsa-problem-daj85j89.lp
Reading time = 97.26 seconds
obj: 27785306 rows, 7218241 columns, 49079448 nonzeros
Gurobi Optimizer version 9.5.2 build v9.5.2rc0 (win64)
Thread count: 4 physical cores, 8 logical processors, using up to 8 threads
Optimize a model with 27785306 rows, 7218241 columns and 49079448 nonzeros
Model fingerprint: 0xdd0bd0ba
Coefficient statistics:
  Matrix range     [6e-05, 1e+00]
  Objective range  [1e+00, 1e+02]
  Bounds range     [0e+00, 0e+00]
  RHS range        [1e-06, 1e+04]

Concurrent LP optimizer: dual simplex and barrier
Showing barrier log only...

Presolve removed 26734122 rows and 52561 columns (presolve time = 7s) ...
Presolve removed 26734122 rows and 239891 columns (presolve time = 10s) ...
Presolve removed 26734122 rows and 3959924 columns (presolve time = 15s) ...
Presolve removed 26734122 rows and 5381333 columns (presolve time = 33s) ...
Presolve removed 26742789 rows and 5390000 columns (presolve time = 35s) ...
Presolve removed 27242133 rows and 5889344 columns (presolve time = 46s) ...
Presolve removed 27312205 rows and 5889873 columns
Presolve time: 54.97s
Presolved: 473101 rows, 1398440 columns, 2787006 nonzeros

Ordering time: 0.24s

Barrier statistics:
 AA&#39; NZ     : 1.715e+06
 Factor NZ  : 9.577e+06 (roughly 800 MB of memory)
 Factor Ops : 3.059e+08 (less than 1 second per iteration)
 Threads    : 3

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   2.96276861e+11 -1.40679874e+12  3.79e+04 1.74e+01  2.28e+06    57s
   1   4.58936485e+10 -4.58030563e+11  4.60e+03 2.56e-13  3.39e+05    57s
   2   1.84252533e+10 -1.13411858e+11  8.94e+02 1.25e-11  6.93e+04    58s
   3   1.17009849e+10 -1.00546282e+10  4.03e+01 3.81e-12  8.34e+03    59s
   4   9.92174805e+09  3.80666636e+09  7.37e+00 8.53e-13  2.22e+03    59s
   5   9.42958026e+09  6.67117268e+09  3.75e+00 3.41e-13  9.93e+02    60s
   6   9.11898620e+09  7.61141647e+09  2.19e+00 2.13e-13  5.40e+02    60s
   7   8.91976290e+09  8.05736399e+09  1.27e+00 1.28e-13  3.08e+02    61s
   8   8.78294151e+09  8.35332779e+09  6.72e-01 1.71e-13  1.53e+02    61s
   9   8.71611960e+09  8.46258866e+09  3.96e-01 1.71e-13  9.04e+01    62s
  10   8.66800653e+09  8.54468530e+09  2.03e-01 1.14e-13  4.39e+01    63s
  11   8.64811095e+09  8.56950309e+09  1.26e-01 1.14e-13  2.80e+01    63s
  12   8.63549006e+09  8.59281763e+09  7.87e-02 1.14e-13  1.52e+01    64s
  13   8.62258318e+09  8.60050108e+09  3.17e-02 1.14e-13  7.87e+00    64s
  14   8.62029036e+09  8.60529665e+09  2.34e-02 8.53e-14  5.34e+00    65s
  15   8.61805381e+09  8.60731108e+09  1.55e-02 7.09e-14  3.83e+00    65s
  16   8.61752728e+09  8.60847701e+09  1.36e-02 6.60e-14  3.22e+00    66s
  17   8.61617698e+09  8.61004642e+09  8.96e-03 6.66e-14  2.18e+00    66s
  18   8.61535583e+09  8.61118383e+09  6.16e-03 6.43e-14  1.49e+00    67s
  19   8.61443135e+09  8.61186483e+09  2.95e-03 6.24e-14  9.15e-01    68s
  20   8.61433210e+09  8.61205560e+09  2.62e-03 7.01e-14  8.12e-01    68s
  21   8.61408067e+09  8.61260777e+09  1.77e-03 6.81e-14  5.25e-01    69s
  22   8.61395699e+09  8.61303342e+09  1.35e-03 7.89e-14  3.29e-01    70s
  23   8.61384836e+09  8.61315620e+09  9.91e-04 6.45e-14  2.47e-01    70s
  24   8.61375915e+09  8.61328190e+09  7.00e-04 7.76e-14  1.70e-01    71s
  25   8.61367871e+09  8.61334113e+09  4.45e-04 6.80e-14  1.20e-01    71s
  26   8.61362980e+09  8.61340613e+09  2.87e-04 6.61e-14  7.97e-02    72s
  27   8.61358260e+09  8.61346578e+09  1.29e-04 7.04e-14  4.17e-02    73s
  28   8.61356351e+09  8.61350386e+09  7.23e-05 7.52e-14  2.13e-02    73s
  29   8.61356026e+09  8.61351453e+09  6.29e-05 6.84e-14  1.63e-02    74s
  30   8.61355685e+09  8.61352429e+09  5.33e-05 6.10e-14  1.16e-02    74s
  31   8.61355245e+09  8.61352691e+09  4.09e-05 7.78e-14  9.10e-03    75s
  32   8.61354431e+09  8.61353398e+09  1.77e-05 8.05e-14  3.68e-03    75s
  33   8.61354084e+09  8.61353645e+09  7.84e-06 7.70e-14  1.56e-03    76s
  34   8.61353867e+09  8.61353757e+09  1.83e-06 1.74e-11  3.94e-04    76s
  35   8.61353801e+09  8.61353788e+09  2.05e-06 2.31e-11  4.88e-05    77s
  36   8.61353794e+09  8.61353794e+09  3.93e-08 4.72e-12  4.67e-07    78s
  37   8.61353794e+09  8.61353794e+09  3.67e-09 3.24e-13  3.59e-12    78s

Barrier solved model in 37 iterations and 78.02 seconds (43.52 work units)
Optimal objective 8.61353794e+09

Crossover log...

   60456 DPushes remaining with DInf 0.0000000e+00                80s
     797 DPushes remaining with DInf 0.0000000e+00                80s
       0 DPushes remaining with DInf 0.0000000e+00                81s

  158378 PPushes remaining with PInf 0.0000000e+00                81s
   39447 PPushes remaining with PInf 0.0000000e+00                86s
   23133 PPushes remaining with PInf 0.0000000e+00                90s
    5647 PPushes remaining with PInf 0.0000000e+00                96s
    2302 PPushes remaining with PInf 0.0000000e+00               100s
       0 PPushes remaining with PInf 0.0000000e+00               104s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.2516986e-09    104s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  183695    8.6135379e+09   0.000000e+00   0.000000e+00    125s

Solved with barrier
Solved in 183695 iterations and 125.39 seconds (82.16 work units)
Optimal objective  8.613537940e+09
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:pypsa.linopf:Optimization successful. Objective value: 8.61e+09
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&#39;ok&#39;, &#39;optimal&#39;)
</pre></div></div>
</div>
</section>
<section id="Power-output-by-generation-type">
<h2>Power output by generation type<a class="headerlink" href="#Power-output-by-generation-type" title="Link to this heading">#</a></h2>
<p>Group the generators by the carrier, and print their summed power outputs over the simulation period.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_by_carrier</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">generators_t</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span>
    <span class="n">network</span><span class="o">.</span><span class="n">generators</span><span class="o">.</span><span class="n">carrier</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">storage_by_carrier</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">storage_units_t</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span>
    <span class="n">network</span><span class="o">.</span><span class="n">storage_units</span><span class="o">.</span><span class="n">carrier</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># to show on graph set the negative storage values to zero</span>
<span class="n">storage_by_carrier</span><span class="p">[</span><span class="n">storage_by_carrier</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">p_by_carrier</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">p_by_carrier</span><span class="p">,</span> <span class="n">storage_by_carrier</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># interconnector exports</span>
<span class="n">exports</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">loads_t</span><span class="o">.</span><span class="n">p</span>
<span class="c1"># multiply by negative one to convert it as a generator</span>
<span class="c1"># i.e. export is a positive load, but negative generator</span>
<span class="n">exports</span><span class="p">[</span><span class="s1">&#39;Interconnectors Export&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exports</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">6</span><span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">interconnector_export</span> <span class="o">=</span> <span class="n">exports</span><span class="p">[[</span><span class="s1">&#39;Interconnectors Export&#39;</span><span class="p">]]</span>

<span class="c1"># group biomass stuff</span>
<span class="n">p_by_carrier</span><span class="p">[</span><span class="s1">&#39;Biomass&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">p_by_carrier</span><span class="p">[</span><span class="s1">&#39;Biomass (dedicated)&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">p_by_carrier</span><span class="p">[</span><span class="s1">&#39;Biomass (co-firing)&#39;</span><span class="p">]</span> <span class="o">+</span>
    <span class="n">p_by_carrier</span><span class="p">[</span><span class="s1">&#39;Landfill Gas&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">p_by_carrier</span><span class="p">[</span><span class="s1">&#39;Anaerobic Digestion&#39;</span><span class="p">]</span> <span class="o">+</span>
    <span class="n">p_by_carrier</span><span class="p">[</span><span class="s1">&#39;Sewage Sludge Digestion&#39;</span><span class="p">])</span>

<span class="c1"># rename the hydro bit</span>
<span class="n">p_by_carrier</span> <span class="o">=</span> <span class="n">p_by_carrier</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Large Hydro&#39;</span><span class="p">:</span> <span class="s1">&#39;Hydro&#39;</span><span class="p">})</span>
<span class="n">p_by_carrier</span> <span class="o">=</span> <span class="n">p_by_carrier</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Interconnector&#39;</span><span class="p">:</span> <span class="s1">&#39;Interconnectors Import&#39;</span><span class="p">})</span>

<span class="o">%</span><span class="k">store</span> p_by_carrier
<span class="n">p_by_carrier</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Stored &#39;p_by_carrier&#39; (DataFrame)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>carrier</th>
      <th>Anaerobic Digestion</th>
      <th>Biomass (co-firing)</th>
      <th>Biomass (dedicated)</th>
      <th>Coal</th>
      <th>EfW Incineration</th>
      <th>Interconnectors Import</th>
      <th>Landfill Gas</th>
      <th>Hydro</th>
      <th>Natural Gas</th>
      <th>Nuclear</th>
      <th>Oil</th>
      <th>Sewage Sludge Digestion</th>
      <th>Shoreline Wave</th>
      <th>Small Hydro</th>
      <th>Solar Photovoltaics</th>
      <th>Tidal Barrage and Tidal Stream</th>
      <th>Wind Offshore</th>
      <th>Wind Onshore</th>
      <th>Pumped Storage Hydroelectric</th>
      <th>Biomass</th>
    </tr>
    <tr>
      <th>snapshot</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018-01-01 00:00:00</th>
      <td>315.200000</td>
      <td>0.00</td>
      <td>19.929</td>
      <td>531.542613</td>
      <td>396.576</td>
      <td>3163.499962</td>
      <td>743.5</td>
      <td>312.435669</td>
      <td>8408.289311</td>
      <td>6833.530000</td>
      <td>0.0</td>
      <td>50.2</td>
      <td>24.0</td>
      <td>40.564332</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>5322.763752</td>
      <td>6499.869774</td>
      <td>0.000000</td>
      <td>1128.829000</td>
    </tr>
    <tr>
      <th>2018-01-01 01:00:00</th>
      <td>315.200000</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000000</td>
      <td>396.576</td>
      <td>2756.500024</td>
      <td>743.5</td>
      <td>308.010233</td>
      <td>9659.233814</td>
      <td>6833.530000</td>
      <td>0.0</td>
      <td>50.2</td>
      <td>24.0</td>
      <td>39.989766</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>5318.656864</td>
      <td>6233.178739</td>
      <td>87.824506</td>
      <td>1108.900000</td>
    </tr>
    <tr>
      <th>2018-01-01 02:00:00</th>
      <td>315.200000</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000000</td>
      <td>396.576</td>
      <td>2771.499986</td>
      <td>743.5</td>
      <td>293.406300</td>
      <td>9966.011464</td>
      <td>6833.530000</td>
      <td>0.0</td>
      <td>50.2</td>
      <td>24.0</td>
      <td>38.093700</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>5315.245105</td>
      <td>6067.016448</td>
      <td>108.320942</td>
      <td>1108.900000</td>
    </tr>
    <tr>
      <th>2018-01-01 03:00:00</th>
      <td>315.200000</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000000</td>
      <td>396.576</td>
      <td>2626.499986</td>
      <td>743.5</td>
      <td>247.824325</td>
      <td>9089.901296</td>
      <td>6833.530000</td>
      <td>0.0</td>
      <td>50.2</td>
      <td>24.0</td>
      <td>32.175674</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>5312.001825</td>
      <td>5988.198334</td>
      <td>64.542325</td>
      <td>1108.900000</td>
    </tr>
    <tr>
      <th>2018-01-01 04:00:00</th>
      <td>315.200000</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.000000</td>
      <td>396.576</td>
      <td>2625.499957</td>
      <td>743.5</td>
      <td>240.743629</td>
      <td>8113.400619</td>
      <td>6833.530000</td>
      <td>0.0</td>
      <td>50.2</td>
      <td>24.0</td>
      <td>31.256368</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>5306.942938</td>
      <td>5794.067604</td>
      <td>116.232547</td>
      <td>1108.900000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2018-12-31 19:00:00</th>
      <td>313.200000</td>
      <td>509.54</td>
      <td>2272.563</td>
      <td>1961.000000</td>
      <td>396.576</td>
      <td>3055.999925</td>
      <td>743.5</td>
      <td>228.226867</td>
      <td>15592.283677</td>
      <td>6421.493102</td>
      <td>0.0</td>
      <td>50.2</td>
      <td>23.0</td>
      <td>30.493284</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>4149.432488</td>
      <td>7359.397105</td>
      <td>717.694273</td>
      <td>3889.003000</td>
    </tr>
    <tr>
      <th>2018-12-31 20:00:00</th>
      <td>305.369979</td>
      <td>509.54</td>
      <td>2272.563</td>
      <td>1961.000000</td>
      <td>396.576</td>
      <td>2717.000034</td>
      <td>728.8</td>
      <td>166.189638</td>
      <td>11726.975149</td>
      <td>6389.273102</td>
      <td>0.0</td>
      <td>50.2</td>
      <td>23.0</td>
      <td>21.663203</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>4517.427141</td>
      <td>7497.608542</td>
      <td>1459.314444</td>
      <td>3866.472979</td>
    </tr>
    <tr>
      <th>2018-12-31 21:00:00</th>
      <td>305.000000</td>
      <td>509.54</td>
      <td>2272.563</td>
      <td>1961.000000</td>
      <td>396.576</td>
      <td>2714.000037</td>
      <td>717.4</td>
      <td>163.239527</td>
      <td>9283.591418</td>
      <td>6357.053102</td>
      <td>0.0</td>
      <td>50.2</td>
      <td>23.0</td>
      <td>21.278649</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>4932.236202</td>
      <td>7594.110625</td>
      <td>347.661359</td>
      <td>3854.703000</td>
    </tr>
    <tr>
      <th>2018-12-31 22:00:00</th>
      <td>305.000000</td>
      <td>509.54</td>
      <td>2272.563</td>
      <td>1961.000000</td>
      <td>396.576</td>
      <td>2774.000030</td>
      <td>717.4</td>
      <td>159.502717</td>
      <td>6256.646750</td>
      <td>6324.833102</td>
      <td>0.0</td>
      <td>50.2</td>
      <td>23.0</td>
      <td>20.791546</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>5252.235248</td>
      <td>7119.589785</td>
      <td>600.121632</td>
      <td>3854.703000</td>
    </tr>
    <tr>
      <th>2018-12-31 23:00:00</th>
      <td>305.000000</td>
      <td>509.54</td>
      <td>2272.563</td>
      <td>1961.000000</td>
      <td>396.576</td>
      <td>1182.000015</td>
      <td>717.4</td>
      <td>168.353054</td>
      <td>7008.856617</td>
      <td>6292.613102</td>
      <td>0.0</td>
      <td>50.2</td>
      <td>23.0</td>
      <td>21.945209</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>5246.397310</td>
      <td>6947.055628</td>
      <td>0.000000</td>
      <td>3854.703000</td>
    </tr>
  </tbody>
</table>
<p>8760 rows Ã— 20 columns</p>
</div></div>
</div>
<p>Graph the power output of the different generation typesâ€¦</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Nuclear&quot;</span><span class="p">,</span> <span class="s1">&#39;Shoreline Wave&#39;</span><span class="p">,</span> <span class="s1">&#39;Biomass&#39;</span><span class="p">,</span>
        <span class="s1">&#39;EfW Incineration&#39;</span><span class="p">,</span>
        <span class="s2">&quot;Coal&quot;</span><span class="p">,</span> <span class="s2">&quot;Oil&quot;</span><span class="p">,</span> <span class="s2">&quot;Natural Gas&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Pumped Storage Hydroelectric&quot;</span><span class="p">,</span> <span class="s1">&#39;Hydro&#39;</span><span class="p">,</span>
        <span class="s2">&quot;Wind Offshore&quot;</span><span class="p">,</span> <span class="s1">&#39;Wind Onshore&#39;</span><span class="p">,</span> <span class="s1">&#39;Solar Photovoltaics&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Interconnectors Import&#39;</span>
        <span class="p">]</span>

<span class="n">p_by_carrier</span> <span class="o">=</span> <span class="n">p_by_carrier</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>

<span class="n">p_by_carrier</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
    <span class="p">(</span><span class="n">p_by_carrier</span><span class="o">.</span><span class="n">max</span><span class="p">()[</span><span class="n">p_by_carrier</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">50.0</span><span class="p">])</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Coal&quot;</span><span class="p">:</span> <span class="s2">&quot;grey&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Diesel/Gas oil&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Diesel/gas Diesel/Gas oil&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
          <span class="s1">&#39;Oil&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Anaerobic Digestion&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;EfW Incineration&#39;</span><span class="p">:</span> <span class="s1">&#39;chocolate&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Sewage Sludge Digestion&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Landfill Gas&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Biomass (dedicated)&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Biomass (co-firing)&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Biomass&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Interconnectors Import&#39;</span><span class="p">:</span> <span class="s1">&#39;pink&#39;</span><span class="p">,</span>
          <span class="s2">&quot;Sour gas&quot;</span><span class="p">:</span> <span class="s2">&quot;lightcoral&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Natural Gas&quot;</span><span class="p">:</span> <span class="s2">&quot;lightcoral&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Nuclear&quot;</span><span class="p">:</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span>
          <span class="s1">&#39;Shoreline Wave&#39;</span><span class="p">:</span> <span class="s1">&#39;aqua&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Tidal Barrage and Tidal Stream&#39;</span><span class="p">:</span> <span class="s1">&#39;aqua&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Hydro&#39;</span><span class="p">:</span> <span class="s2">&quot;turquoise&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Large Hydro&quot;</span><span class="p">:</span> <span class="s2">&quot;turquoise&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Small Hydro&quot;</span><span class="p">:</span> <span class="s2">&quot;turquoise&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Pumped Storage Hydroelectric&quot;</span><span class="p">:</span> <span class="s2">&quot;darkturquoise&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Wind Offshore&quot;</span><span class="p">:</span> <span class="s2">&quot;lightskyblue&quot;</span><span class="p">,</span>
          <span class="s1">&#39;Wind Onshore&#39;</span><span class="p">:</span> <span class="s1">&#39;deepskyblue&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Solar Photovoltaics&#39;</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">}</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="p">(</span><span class="n">p_by_carrier</span> <span class="o">/</span> <span class="mf">1e3</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;area&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">p_by_carrier</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>

<span class="c1"># stacked area plot of negative values, prepend column names with &#39;_&#39; such that they don&#39;t appear in the legend</span>
<span class="p">(</span><span class="n">interconnector_export</span> <span class="o">/</span> <span class="mf">1e3</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">area</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
<span class="c1"># rescale the y axis</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([(</span><span class="n">interconnector_export</span> <span class="o">/</span> <span class="mf">1e3</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="p">(</span><span class="n">p_by_carrier</span> <span class="o">/</span> <span class="mf">1e3</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>

<span class="c1"># Shrink current axis&#39;s height by 10% on the bottom</span>
<span class="n">box</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">box</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">box</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>
                 <span class="n">box</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="mf">0.9</span><span class="p">])</span>

<span class="c1"># Put a legend below current axis</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">),</span>
          <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;GW&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\Users\alyden\Anaconda3\envs\PyPSA-GB\lib\site-packages\pandas\plotting\_matplotlib\core.py:1391: UserWarning: Attempting to set identical bottom == top == 0.0 results in singular transformations; automatically expanding.
  ax.set_ylim(None, 0)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0, &#39;&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_9_-_Comparison_To_Historical_Data_20_2.png" src="../_images/notebooks_9_-_Comparison_To_Historical_Data_20_2.png" />
</div>
</div>
</section>
<section id="Simulated-vs-historical-data-power-generation">
<h2>Simulated vs historical data power generation<a class="headerlink" href="#Simulated-vs-historical-data-power-generation" title="Link to this heading">#</a></h2>
<p>We can group the generators by type and sum to calculate the total simulated power generation over the year in TWh.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">store</span> -r p_by_carrier

<span class="n">p_by_carrier</span> <span class="o">=</span> <span class="n">p_by_carrier</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1000000</span>
<span class="c1"># print(p_by_carrier)</span>
<span class="n">p_by_carrier</span><span class="p">[</span><span class="s1">&#39;Hydro&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_by_carrier</span><span class="p">[</span><span class="s1">&#39;Small Hydro&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">p_by_carrier</span><span class="p">[</span><span class="s1">&#39;Hydro&#39;</span><span class="p">]</span>
<span class="n">p_by_carrier</span><span class="p">[</span><span class="s1">&#39;Oil&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">p_by_carrier</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Small Hydro&#39;</span><span class="p">,</span> <span class="s1">&#39;Anaerobic Digestion&#39;</span><span class="p">,</span> <span class="s1">&#39;Biomass (co-firing)&#39;</span><span class="p">,</span> <span class="s1">&#39;Biomass (dedicated)&#39;</span><span class="p">,</span> <span class="s1">&#39;Landfill Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;Sewage Sludge Digestion&#39;</span><span class="p">,</span> <span class="s1">&#39;Shoreline Wave&#39;</span><span class="p">,</span> <span class="s1">&#39;Tidal Barrage and Tidal Stream&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">p_by_carrier</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
carrier
Coal                              2.918946
EfW Incineration                  3.474006
Interconnectors Import           21.929185
Hydro                             2.849449
Natural Gas                     139.811284
Nuclear                          59.559250
Oil                               0.000000
Solar Photovoltaics              14.709712
Wind Offshore                    26.046430
Wind Onshore                     28.865750
Pumped Storage Hydroelectric      0.566678
Biomass                          31.103247
dtype: float64
</pre></div></div>
</div>
<p>Then the total of all simulated power generation is:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_by_carrier</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
331.8339366483934
</pre></div></div>
</div>
<p>BEIS publish reports on power generation. We extracted the data for 2018 from â€œTable 5c: electricity supplied by fuel 1998 to 2020 (TWh)â€ in ET5.1 (power generation) and ET5.6 (imports) <a class="reference external" href="https://www.gov.uk/government/statistics/electricity-section-5-energy-trends">https://www.gov.uk/government/statistics/electricity-section-5-energy-trends</a>. Additional data for EfW Incineration was obtained from the DUKES dataset <a class="reference external" href="https://www.gov.uk/government/collections/digest-of-uk-energy-statistics-dukes">https://www.gov.uk/government/collections/digest-of-uk-energy-statistics-dukes</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Coal&#39;</span><span class="p">:</span> <span class="mf">16.0</span><span class="p">,</span>
        <span class="s1">&#39;EfW Incineration&#39;</span><span class="p">:</span> <span class="mf">3.5</span><span class="p">,</span>
        <span class="s1">&#39;Interconnectors Import&#39;</span><span class="p">:</span> <span class="mf">21.9</span><span class="p">,</span>
        <span class="s1">&#39;Hydro&#39;</span><span class="p">:</span> <span class="mf">5.4</span><span class="p">,</span>
        <span class="s1">&#39;Natural Gas&#39;</span><span class="p">:</span> <span class="mf">129.1</span><span class="p">,</span>
        <span class="s1">&#39;Nuclear&#39;</span><span class="p">:</span> <span class="mf">59.1</span><span class="p">,</span>
        <span class="s1">&#39;Oil&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="s1">&#39;Solar Photovoltaics&#39;</span><span class="p">:</span> <span class="mf">12.7</span><span class="p">,</span>
        <span class="s1">&#39;Wind Offshore&#39;</span><span class="p">:</span> <span class="mf">26.5</span><span class="p">,</span>
        <span class="s1">&#39;Wind Onshore&#39;</span><span class="p">:</span> <span class="mf">30.4</span><span class="p">,</span>
        <span class="s1">&#39;Pumped Storage Hydroelectric&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s1">&#39;Biomass&#39;</span><span class="p">:</span> <span class="mf">31.5</span>
        <span class="p">}</span>
<span class="n">data_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">data_series</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Coal                             16.0
EfW Incineration                  3.5
Interconnectors Import           21.9
Hydro                             5.4
Natural Gas                     129.1
Nuclear                          59.1
Oil                               1.0
Solar Photovoltaics              12.7
Wind Offshore                    26.5
Wind Onshore                     30.4
Pumped Storage Hydroelectric      0.0
Biomass                          31.5
dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_series</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
337.09999999999997
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_series</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index([&#39;Coal&#39;, &#39;EfW Incineration&#39;, &#39;Interconnectors Import&#39;, &#39;Hydro&#39;,
       &#39;Natural Gas&#39;, &#39;Nuclear&#39;, &#39;Oil&#39;, &#39;Solar Photovoltaics&#39;, &#39;Wind Offshore&#39;,
       &#39;Wind Onshore&#39;, &#39;Pumped Storage Hydroelectric&#39;, &#39;Biomass&#39;],
      dtype=&#39;object&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mylabels = data_series.index</span>
<span class="c1"># mycolors = categorical_cmap(3, 10)</span>

<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Coal&quot;</span><span class="p">:</span> <span class="s2">&quot;grey&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Diesel/Gas oil&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Diesel/gas Diesel/Gas oil&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
          <span class="s1">&#39;Oil&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Anaerobic Digestion&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;EfW Incineration&#39;</span><span class="p">:</span> <span class="s1">&#39;chocolate&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Sewage Sludge Digestion&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Landfill Gas&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Biomass (dedicated)&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Biomass (co-firing)&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Biomass&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Interconnectors Import&#39;</span><span class="p">:</span> <span class="s1">&#39;pink&#39;</span><span class="p">,</span>
          <span class="s2">&quot;Sour gas&quot;</span><span class="p">:</span> <span class="s2">&quot;lightcoral&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Natural Gas&quot;</span><span class="p">:</span> <span class="s2">&quot;lightcoral&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Nuclear&quot;</span><span class="p">:</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span>
          <span class="s1">&#39;Shoreline Wave&#39;</span><span class="p">:</span> <span class="s1">&#39;aqua&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Tidal Barrage and Tidal Stream&#39;</span><span class="p">:</span> <span class="s1">&#39;aqua&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Hydro&#39;</span><span class="p">:</span> <span class="s2">&quot;turquoise&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Large Hydro&quot;</span><span class="p">:</span> <span class="s2">&quot;turquoise&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Small Hydro&quot;</span><span class="p">:</span> <span class="s2">&quot;turquoise&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Pumped Storage Hydroelectric&quot;</span><span class="p">:</span> <span class="s2">&quot;darkturquoise&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Wind Offshore&quot;</span><span class="p">:</span> <span class="s2">&quot;lightskyblue&quot;</span><span class="p">,</span>
          <span class="s1">&#39;Wind Onshore&#39;</span><span class="p">:</span> <span class="s1">&#39;deepskyblue&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Solar Photovoltaics&#39;</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">}</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">data_series</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">data_series</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">p_by_carrier</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">autopct</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%1.1f%%</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">pctdistance</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">labeldistance</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Historical data&#39;</span><span class="p">)</span>

<span class="n">simulated_generation</span> <span class="o">=</span> <span class="n">p_by_carrier</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">simulated_generation</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">simulated_generation</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">p_by_carrier</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">autopct</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%1.1f%%</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">pctdistance</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">labeldistance</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Simulated data&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_9_-_Comparison_To_Historical_Data_30_0.png" src="../_images/notebooks_9_-_Comparison_To_Historical_Data_30_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">simulated_generation</span><span class="p">,</span> <span class="n">data_series</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Simulated&#39;</span><span class="p">,</span> <span class="s1">&#39;Historical&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Simulated - Historical&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Simulated&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Historical&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Simulated (%)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Simulated&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Simulated&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Historical (%)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Historical&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Historical&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Simulated (%) - Historical (%)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Simulated (%)&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Historical (%)&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Total&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Simulated</th>
      <th>Historical</th>
      <th>Simulated - Historical</th>
      <th>Simulated (%)</th>
      <th>Historical (%)</th>
      <th>Simulated (%) - Historical (%)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Coal</th>
      <td>2.9</td>
      <td>16.0</td>
      <td>-13.1</td>
      <td>0.9</td>
      <td>4.7</td>
      <td>-3.8</td>
    </tr>
    <tr>
      <th>EfW Incineration</th>
      <td>3.5</td>
      <td>3.5</td>
      <td>0.0</td>
      <td>1.1</td>
      <td>1.0</td>
      <td>0.1</td>
    </tr>
    <tr>
      <th>Interconnectors Import</th>
      <td>21.9</td>
      <td>21.9</td>
      <td>0.0</td>
      <td>6.6</td>
      <td>6.5</td>
      <td>0.1</td>
    </tr>
    <tr>
      <th>Hydro</th>
      <td>2.8</td>
      <td>5.4</td>
      <td>-2.6</td>
      <td>0.8</td>
      <td>1.6</td>
      <td>-0.8</td>
    </tr>
    <tr>
      <th>Natural Gas</th>
      <td>139.8</td>
      <td>129.1</td>
      <td>10.7</td>
      <td>42.1</td>
      <td>38.3</td>
      <td>3.8</td>
    </tr>
    <tr>
      <th>Nuclear</th>
      <td>59.6</td>
      <td>59.1</td>
      <td>0.5</td>
      <td>18.0</td>
      <td>17.5</td>
      <td>0.5</td>
    </tr>
    <tr>
      <th>Oil</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>-1.0</td>
      <td>0.0</td>
      <td>0.3</td>
      <td>-0.3</td>
    </tr>
    <tr>
      <th>Solar Photovoltaics</th>
      <td>14.7</td>
      <td>12.7</td>
      <td>2.0</td>
      <td>4.4</td>
      <td>3.8</td>
      <td>0.6</td>
    </tr>
    <tr>
      <th>Wind Offshore</th>
      <td>26.0</td>
      <td>26.5</td>
      <td>-0.5</td>
      <td>7.8</td>
      <td>7.9</td>
      <td>-0.1</td>
    </tr>
    <tr>
      <th>Wind Onshore</th>
      <td>28.9</td>
      <td>30.4</td>
      <td>-1.5</td>
      <td>8.7</td>
      <td>9.0</td>
      <td>-0.3</td>
    </tr>
    <tr>
      <th>Pumped Storage Hydroelectric</th>
      <td>0.6</td>
      <td>0.0</td>
      <td>0.6</td>
      <td>0.2</td>
      <td>0.0</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>Biomass</th>
      <td>31.1</td>
      <td>31.5</td>
      <td>-0.4</td>
      <td>9.4</td>
      <td>9.3</td>
      <td>0.1</td>
    </tr>
    <tr>
      <th>Total</th>
      <td>331.8</td>
      <td>337.1</td>
      <td>-5.3</td>
      <td>100.0</td>
      <td>99.9</td>
      <td>0.1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Looking at table above we can see (i) Gas too high, and (ii) Coal too low.</p>
<p>Likely due to price dynamics of gas and coal which are not fully captured in marginal cost, e.g., capacity markets.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_series</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">data_series</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;Pumped Storage Hydroelectric&#39;</span><span class="p">:</span> <span class="s1">&#39;Pumped Storage&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data_series</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;Interconnectors Import&#39;</span><span class="p">:</span> <span class="s1">&#39;Interconnectors&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_series</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data_series</span><span class="o">.</span><span class="n">values</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">p_by_carrier</span><span class="o">.</span><span class="n">values</span>

<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">width</span> <span class="o">=</span> <span class="mf">0.35</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data from BEIS&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span> <span class="o">+</span> <span class="n">width</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Output from PyPSA-GB&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Generation by type in 2018 (TWh)&#39;</span><span class="p">)</span>
<span class="c1"># plt.title(&#39;Scores by group and gender&#39;)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ind</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">data_series</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Coal                    16.0
EfW Incineration         3.5
Interconnectors         21.9
Hydro                    5.4
Natural Gas            129.1
Nuclear                 59.1
Oil                      1.0
Solar Photovoltaics     12.7
Wind Offshore           26.5
Wind Onshore            30.4
Pumped Storage           0.0
Biomass                 31.5
dtype: float64
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_9_-_Comparison_To_Historical_Data_33_1.png" src="../_images/notebooks_9_-_Comparison_To_Historical_Data_33_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Setting-up-simulation">Setting up simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Running-the-optimisation">Running the optimisation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Power-output-by-generation-type">Power output by generation type</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Simulated-vs-historical-data-power-generation">Simulated vs historical data power generation</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      Â© Copyright 2021-2026, Andrew Lyden, University of Edinburgh.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__center">
      
        <div class="footer-item">

  <p class="copyright">
    
      Â© Copyright 2021-2026, Andrew Lyden, University of Edinburgh.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>
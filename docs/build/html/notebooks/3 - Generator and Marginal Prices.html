<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Generator and Marginal Prices &mdash; PyPSA-GB  documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Renewable Power and Storage" href="4%20-%20Renewable%20Power%20and%20Storage.html" />
    <link rel="prev" title="Demand" href="2%20-%20Demand.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> PyPSA-GB
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Data and Functionality</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="1%20-%20Network.html">Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="2%20-%20Demand.html">Demand</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Generator and Marginal Prices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Visualising-installed-capacities-for-individual-years">Visualising installed capacities for individual years</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Marginal-prices-for-fossil-fuel-power-plants">Marginal prices for fossil fuel power plants</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="4%20-%20Renewable%20Power%20and%20Storage.html">Renewable Power and Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="5a%20-%20LOPF%20Historical.html">Historical Network Constrained Linear Optimal Power Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="5b%20-%20LOPF%20Future.html">Future Network Constrained Linear Optimal Power Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="6%20-%20Unit%20Commitment.html">Unit Commitment</a></li>
<li class="toctree-l1"><a class="reference internal" href="9%20-%20Comparison%20To%20Historical%20Data.html">Comparison To Historical Data</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="7%20-%20Network%20Expansion.html">Network Expansion</a></li>
<li class="toctree-l1"><a class="reference internal" href="5c%20-%20LOPF%20Future%20-%20Floating%20Wind%2C%20Marine%20and%20Emissions%20Modelling.html">Floating Wind &amp; Marine, and Emissions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyPSA-GB</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Generator and Marginal Prices</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/3 - Generator and Marginal Prices.nblink.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Generator-and-Marginal-Prices">
<h1>Generator and Marginal Prices<a class="headerlink" href="#Generator-and-Marginal-Prices" title="Permalink to this headline">¶</a></h1>
<p>This notebook explores the dispatchable generators data included in PyPSA-GB. The primary datasource is the DUKES 5.11: Power stations in the United Kingdom (<a class="reference external" href="https://www.gov.uk/government/collections/digest-of-uk-energy-statistics-dukes">https://www.gov.uk/government/collections/digest-of-uk-energy-statistics-dukes</a>) dataset contains information on large-scale power generators in the UK. It is used to obtain the regional location, fuel, type, and installed capacity of all the conventional, non-renewable power plants. Coordinates of locations are contained in
power_station_locations.csv where data has been obtained from <a class="reference external" href="https://en.wikipedia.org/wiki/List_of_power_stations_in_England">https://en.wikipedia.org/wiki/List_of_power_stations_in_England</a>, <a class="reference external" href="https://en.wikipedia.org/wiki/List_of_power_stations_in_Scotland">https://en.wikipedia.org/wiki/List_of_power_stations_in_Scotland</a>, <a class="reference external" href="https://en.wikipedia.org/wiki/List_of_power_stations_in_Wales">https://en.wikipedia.org/wiki/List_of_power_stations_in_Wales</a>, <a class="reference external" href="https://www.gem.wiki/">https://www.gem.wiki/</a>, and Google Map searches. Fuel of power stations extracted from this database are: coal, diesel, natural gas, nuclear, sour gas, and waste (anaerobic digestion).</p>
<p>The technical characteristics of dispatchable generators are from various sources. For coal, oil, CCGT, OCGT, and nuclear, see <a class="reference external" href="https://www.diw.de/documents/publikationen/73/diw_01.c.424566.de/diw_datadoc_2013-068.pdf">https://www.diw.de/documents/publikationen/73/diw_01.c.424566.de/diw_datadoc_2013-068.pdf</a>. For hydro: <a class="reference external" href="https://coreproject-dk.com/wp-content/uploads/2018/11/WP3-pre-report.pdf">https://coreproject-dk.com/wp-content/uploads/2018/11/WP3-pre-report.pdf</a>. Hydropower is not modelled as a dispatchable generator, instead historical Elexon generation data is used. Biomass is assumed to have the same characteristics as coal. However, for a large
proportion of the generator types UC-related parameters are too fast to matter at half hourly resolution. Another source for thermal power plants used: <a class="reference external" href="https://doi.org/10.1016/j.energy.2017.04.104">https://doi.org/10.1016/j.energy.2017.04.104</a>.</p>
<p>Marginal costs are calculated using a combination of fuel costs and costs incurred due to the EU Emissions Trading Scheme (ETS). Quarterly fuel costs are sourced using DUKES. Historical daily futures EU ETS prices were sourced from Ember Climate, and Carbon Price Support (a top up to the EU ETS price by UK government) historical prices were sourced from UK Government document <a class="reference external" href="https://researchbriefings.files.parliament.uk/documents/SN05927/SN05927.pdf">https://researchbriefings.files.parliament.uk/documents/SN05927/SN05927.pdf</a>. Nuclear marginal price based on variable O&amp;M
from <a class="reference external" href="https://www.imperial.ac.uk/media/imperial-college/research-centres-and-groups/icept/Cost-estimates-for-nuclear-power-in-the-UK.pdf">https://www.imperial.ac.uk/media/imperial-college/research-centres-and-groups/icept/Cost-estimates-for-nuclear-power-in-the-UK.pdf</a>. Biomass there are estimates of 30-42 Euros/MWh, at 0.35% efficiency, giving median 103 Euros/MWh, and converting to pounds gives 89 £/MWh. Finally, subtract 45 £/MWh for ROC subsidy to give a marginal price of 44 £/MWh.</p>
<div class="section" id="Visualising-installed-capacities-for-individual-years">
<h2>Visualising installed capacities for individual years<a class="headerlink" href="#Visualising-installed-capacities-for-individual-years" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">find_dotenv</span><span class="p">,</span> <span class="n">load_dotenv</span>

<span class="n">load_dotenv</span><span class="p">(</span><span class="n">find_dotenv</span><span class="p">())</span>
<span class="n">src_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PROJECT_SRC&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">src_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">data_reader_writer</span> <span class="kn">import</span> <span class="n">data_writer</span>
<span class="kn">import</span> <span class="nn">marginal_costs</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Choose a year to produce bar graph of installed generator capacities by type…</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">year</span> <span class="o">=</span> <span class="mi">2050</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-12-02 00:00:00&#39;</span>
<span class="n">end</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-12-02 03:30:00&#39;</span>
<span class="c1"># time step as fraction of hour</span>
<span class="n">time_step</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="k">if</span> <span class="n">year</span> <span class="o">&gt;</span> <span class="mi">2020</span><span class="p">:</span>
    <span class="n">data_writer</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">time_step</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">year_baseline</span><span class="o">=</span><span class="mi">2020</span><span class="p">,</span> <span class="n">scenario</span><span class="o">=</span><span class="s1">&#39;Leading The Way&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">year</span> <span class="o">&lt;=</span> <span class="mi">2020</span><span class="p">:</span>
    <span class="n">data_writer</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">time_step</span><span class="p">,</span> <span class="n">year</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\Users\alyden\Anaconda3\envs\PyPSA-GB\lib\site-packages\pandas\core\arrays\datetimes.py:741: PerformanceWarning: Non-vectorized DateOffset being applied to Series or DatetimeIndex
  warnings.warn(
c:\Users\alyden\Anaconda3\envs\PyPSA-GB\lib\site-packages\pandas\core\indexing.py:1667: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self.obj[key] = value
C:\Users\alyden\OneDrive - University of Edinburgh\Python\PyPSA-GB v0.0.1\PyPSA-GB\interconnectors.py:201: UserWarning: This pattern has match groups. To actually get the groups, use str.extract.
  df_FES = df_FES[~df_FES.Variable.str.contains(&#39;(TWh)&#39;)]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_generators</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;LOPF_data/generators.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df_generators</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carrier</th>
      <th>type</th>
      <th>p_nom</th>
      <th>bus</th>
      <th>marginal_cost</th>
      <th>ramp_limit_up</th>
      <th>ramp_limit_down</th>
      <th>p_max_pu</th>
    </tr>
    <tr>
      <th>name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Hywind Scotland Pilot Park (Hywind 2) Demonstrator</th>
      <td>Wind Offshore</td>
      <td>Wind Offshore</td>
      <td>4.770000e+01</td>
      <td>Peterhead</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Beatrice Demonstrator</th>
      <td>Wind Offshore</td>
      <td>Wind Offshore</td>
      <td>1.590000e+01</td>
      <td>Peterhead</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Burbo Bank</th>
      <td>Wind Offshore</td>
      <td>Wind Offshore</td>
      <td>1.431000e+02</td>
      <td>Deeside</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Gunfleet Sands - (Demo) Extension</th>
      <td>Wind Offshore</td>
      <td>Wind Offshore</td>
      <td>1.908000e+01</td>
      <td>Bramford</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Gunfleet Sands II</th>
      <td>Wind Offshore</td>
      <td>Wind Offshore</td>
      <td>1.030320e+02</td>
      <td>Bramford</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Unmet Load London</th>
      <td>Unmet Load</td>
      <td>Unmet Load</td>
      <td>1.000000e+09</td>
      <td>London</td>
      <td>999999999.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Unmet Load Kemsley</th>
      <td>Unmet Load</td>
      <td>Unmet Load</td>
      <td>1.000000e+09</td>
      <td>Kemsley</td>
      <td>999999999.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Unmet Load Sellindge</th>
      <td>Unmet Load</td>
      <td>Unmet Load</td>
      <td>1.000000e+09</td>
      <td>Sellindge</td>
      <td>999999999.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Unmet Load Lovedean</th>
      <td>Unmet Load</td>
      <td>Unmet Load</td>
      <td>1.000000e+09</td>
      <td>Lovedean</td>
      <td>999999999.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Unmet Load S.W.Penisula</th>
      <td>Unmet Load</td>
      <td>Unmet Load</td>
      <td>1.000000e+09</td>
      <td>S.W.Penisula</td>
      <td>999999999.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>2875 rows × 8 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_generators</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_generators</span><span class="p">[</span><span class="s1">&#39;carrier&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Wind Offshore&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carrier</th>
      <th>type</th>
      <th>p_nom</th>
      <th>bus</th>
      <th>marginal_cost</th>
      <th>ramp_limit_up</th>
      <th>ramp_limit_down</th>
      <th>p_max_pu</th>
    </tr>
    <tr>
      <th>name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Hywind Scotland Pilot Park (Hywind 2) Demonstrator</th>
      <td>Wind Offshore</td>
      <td>Wind Offshore</td>
      <td>47.700</td>
      <td>Peterhead</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Beatrice Demonstrator</th>
      <td>Wind Offshore</td>
      <td>Wind Offshore</td>
      <td>15.900</td>
      <td>Peterhead</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Burbo Bank</th>
      <td>Wind Offshore</td>
      <td>Wind Offshore</td>
      <td>143.100</td>
      <td>Deeside</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Gunfleet Sands - (Demo) Extension</th>
      <td>Wind Offshore</td>
      <td>Wind Offshore</td>
      <td>19.080</td>
      <td>Bramford</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Gunfleet Sands II</th>
      <td>Wind Offshore</td>
      <td>Wind Offshore</td>
      <td>103.032</td>
      <td>Bramford</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>NE7</th>
      <td>Wind Offshore</td>
      <td>Floating Wind</td>
      <td>4770.000</td>
      <td>Peterhead</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>NE8</th>
      <td>Wind Offshore</td>
      <td>Floating Wind</td>
      <td>1590.000</td>
      <td>Peterhead</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>E1</th>
      <td>Wind Offshore</td>
      <td>Floating Wind</td>
      <td>4770.000</td>
      <td>Peterhead</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>E2</th>
      <td>Wind Offshore</td>
      <td>Floating Wind</td>
      <td>3180.000</td>
      <td>Peterhead</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>E3</th>
      <td>Wind Offshore</td>
      <td>Floating Wind</td>
      <td>1590.000</td>
      <td>Peterhead</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>76 rows × 8 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">generators_p_nom</span> <span class="o">=</span> <span class="n">df_generators</span><span class="o">.</span><span class="n">p_nom</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span>
    <span class="n">df_generators</span><span class="o">.</span><span class="n">carrier</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
<span class="k">if</span> <span class="n">year</span> <span class="o">&gt;</span> <span class="mi">2020</span><span class="p">:</span>
    <span class="n">generators_p_nom</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Unmet Load&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">generators_p_nom</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">generators_p_nom</span><span class="p">[</span><span class="n">generators_p_nom</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">})</span>
<span class="c1"># bar chart</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">generators_p_nom</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">generators_p_nom</span><span class="o">.</span><span class="n">values</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">generators_p_nom</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;GW&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Installed capacity in year &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_3_-_Generator_and_Marginal_Prices_10_0.png" src="../_images/notebooks_3_-_Generator_and_Marginal_Prices_10_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">generators_p_nom</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
carrier
Biomass (dedicated)      550.512
Landfill Gas             743.500
Large Hydro             1826.660
EfW Incineration        2308.671
CCS Biomass             5079.780
Nuclear                 5443.030
Hydrogen               15211.119
Wind Onshore           42020.408
Wind Offshore          86993.034
Solar Photovoltaics    88585.623
Name: p_nom, dtype: float64
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Marginal-prices-for-fossil-fuel-power-plants">
<h2>Marginal prices for fossil fuel power plants<a class="headerlink" href="#Marginal-prices-for-fossil-fuel-power-plants" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;../data/marginal_cost_data.xlsx&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">fuel_prices</span> <span class="o">=</span> <span class="n">marginal_costs</span><span class="o">.</span><span class="n">fuel_prices_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">carbon_support_price</span> <span class="o">=</span> <span class="n">marginal_costs</span><span class="o">.</span><span class="n">carbon_support_price_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">EU_ETS</span> <span class="o">=</span> <span class="n">marginal_costs</span><span class="o">.</span><span class="n">EU_ETS_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">EU_ETS</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">fuel_prices</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">fuel_prices</span><span class="p">,</span> <span class="n">carbon_support_price</span><span class="p">,</span> <span class="n">EU_ETS</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># exchange euros for pounds</span>
<span class="n">exch</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2010</span><span class="p">:</span> <span class="mf">0.8583</span><span class="p">,</span>
        <span class="mi">2011</span><span class="p">:</span> <span class="mf">0.8678</span><span class="p">,</span>
        <span class="mi">2012</span><span class="p">:</span> <span class="mf">0.8113</span><span class="p">,</span>
        <span class="mi">2013</span><span class="p">:</span> <span class="mf">0.8492</span><span class="p">,</span>
        <span class="mi">2014</span><span class="p">:</span> <span class="mf">0.8061</span><span class="p">,</span>
        <span class="mi">2015</span><span class="p">:</span> <span class="mf">0.7263</span><span class="p">,</span>
        <span class="mi">2016</span><span class="p">:</span> <span class="mf">0.8193</span><span class="p">,</span>
        <span class="mi">2017</span><span class="p">:</span> <span class="mf">0.8766</span><span class="p">,</span>
        <span class="mi">2018</span><span class="p">:</span> <span class="mf">0.8850</span><span class="p">,</span>
        <span class="mi">2019</span><span class="p">:</span> <span class="mf">0.8773</span><span class="p">,</span>
        <span class="mi">2020</span><span class="p">:</span> <span class="mf">0.8897</span><span class="p">}</span>

<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">2021</span><span class="p">):</span>
    <span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;EU ETS (Euros/tonne)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">):</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)]</span> <span class="o">*=</span> <span class="n">exch</span><span class="p">[</span><span class="n">year</span><span class="p">]</span>
<span class="n">result</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;EU ETS (Euros/tonne)&#39;</span><span class="p">:</span> <span class="s1">&#39;EU ETS (Pounds/tonne)&#39;</span><span class="p">},</span>
    <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># these are from</span>
<span class="c1"># https://www.parliament.uk/globalassets/documents/post/postpn_383-carbon-footprint-electricity-generation.pdf</span>
<span class="n">coal_emission_factor</span> <span class="o">=</span> <span class="mi">846</span>
<span class="c1"># really should be different between OCGT and CCGT</span>
<span class="n">gas_emission_factor</span> <span class="o">=</span> <span class="mi">488</span>
<span class="c1"># need better reference for oil</span>
<span class="c1"># https://www.jcm.go.jp/cl-jp/methodologies/68/attached_document2</span>
<span class="n">oil_emission_factor</span> <span class="o">=</span> <span class="mi">533</span>

<span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Gas carbon tax (p/kWh)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">result</span><span class="p">[</span><span class="s1">&#39;Carbon support price (Pounds/tonne)&#39;</span><span class="p">]</span> <span class="o">+</span>
    <span class="n">result</span><span class="p">[</span><span class="s1">&#39;EU ETS (Pounds/tonne)&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">gas_emission_factor</span> <span class="o">/</span> <span class="mi">10000</span>
<span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Coal carbon tax (p/kWh)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">result</span><span class="p">[</span><span class="s1">&#39;Carbon support price (Pounds/tonne)&#39;</span><span class="p">]</span> <span class="o">+</span>
    <span class="n">result</span><span class="p">[</span><span class="s1">&#39;EU ETS (Pounds/tonne)&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">coal_emission_factor</span> <span class="o">/</span> <span class="mi">10000</span>
<span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Oil carbon tax (p/kWh)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">result</span><span class="p">[</span><span class="s1">&#39;Carbon support price (Pounds/tonne)&#39;</span><span class="p">]</span> <span class="o">+</span>
    <span class="n">result</span><span class="p">[</span><span class="s1">&#39;EU ETS (Pounds/tonne)&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">oil_emission_factor</span> <span class="o">/</span> <span class="mi">10000</span>

<span class="c1"># converting to £/MWh</span>
<span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Gas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">result</span><span class="p">[</span><span class="s1">&#39;Gas carbon tax (p/kWh)&#39;</span><span class="p">]</span> <span class="o">+</span>
    <span class="n">result</span><span class="p">[</span><span class="s1">&#39;Gas (p/kWh)&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">10</span>
<span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Coal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">result</span><span class="p">[</span><span class="s1">&#39;Coal carbon tax (p/kWh)&#39;</span><span class="p">]</span> <span class="o">+</span>
    <span class="n">result</span><span class="p">[</span><span class="s1">&#39;Coal (p/kWh)&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">10</span>
<span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Oil&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">result</span><span class="p">[</span><span class="s1">&#39;Oil carbon tax (p/kWh)&#39;</span><span class="p">]</span> <span class="o">+</span>
    <span class="n">result</span><span class="p">[</span><span class="s1">&#39;Oil (p/kWh)&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">10</span>

<span class="n">frame</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Coal fuel price (£/MWh)&#39;</span><span class="p">:</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;Coal (p/kWh)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span>
         <span class="s1">&#39;Carbon support price (£/MWh)&#39;</span><span class="p">:</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;Carbon support price (Pounds/tonne)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">coal_emission_factor</span> <span class="o">/</span> <span class="mi">10000</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span>
         <span class="s1">&#39;EU ETS (£/MWh)&#39;</span><span class="p">:</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;EU ETS (Pounds/tonne)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">coal_emission_factor</span> <span class="o">/</span> <span class="mi">10000</span> <span class="o">*</span> <span class="mi">10</span><span class="p">}</span>
<span class="n">df_coal</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="n">df_coal</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">area</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;What constitutes the marginal price for coal?&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_3_-_Generator_and_Marginal_Prices_14_0.png" src="../_images/notebooks_3_-_Generator_and_Marginal_Prices_14_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;Coal&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Coal fuel + carbon tax&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;Gas&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gas fuel + carbon tax&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Flipping the cheapest fossil fuel marginal generator type from coal to gas&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_3_-_Generator_and_Marginal_Prices_15_0.png" src="../_images/notebooks_3_-_Generator_and_Marginal_Prices_15_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">marginal_prices</span> <span class="o">=</span> <span class="n">result</span><span class="p">[[</span><span class="s1">&#39;Coal&#39;</span><span class="p">,</span> <span class="s1">&#39;Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;Oil&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marginal_prices</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Coal price + carbon (£/MWh)&#39;</span><span class="p">,</span> <span class="s1">&#39;Gas price + carbon (£/MWh)&#39;</span><span class="p">,</span> <span class="s1">&#39;Oil price + carbon (£/MWh)&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Coal, gas, and oil historical marginal price&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_3_-_Generator_and_Marginal_Prices_16_0.png" src="../_images/notebooks_3_-_Generator_and_Marginal_Prices_16_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add the future prices</span>

<span class="n">future_fuel_price</span> <span class="o">=</span> <span class="n">marginal_costs</span><span class="o">.</span><span class="n">future_fuel_prices_df</span><span class="p">()</span>
<span class="n">future_fuel_price</span> <span class="o">=</span> <span class="n">future_fuel_price</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">future_carbon_price</span> <span class="o">=</span> <span class="n">marginal_costs</span><span class="o">.</span><span class="n">future_carbon_prices_df</span><span class="p">()</span>
<span class="n">future_carbon_price</span> <span class="o">=</span> <span class="n">future_carbon_price</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>

<span class="n">future_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">future_fuel_price</span><span class="p">,</span> <span class="n">future_carbon_price</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">future_result</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Gas carbon tax (p/kWh)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">future_result</span><span class="p">[</span><span class="s1">&#39;High case&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">gas_emission_factor</span> <span class="o">/</span> <span class="mi">10000</span>
<span class="n">future_result</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Coal carbon tax (p/kWh)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">future_result</span><span class="p">[</span><span class="s1">&#39;High case&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">coal_emission_factor</span> <span class="o">/</span> <span class="mi">10000</span>
<span class="n">future_result</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Oil carbon tax (p/kWh)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">future_result</span><span class="p">[</span><span class="s1">&#39;High case&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">oil_emission_factor</span> <span class="o">/</span> <span class="mi">10000</span>

<span class="c1"># converting to £/MWh</span>
<span class="c1"># gas is in p/therm, divide by 29.3 * 0.5 = 14.65, assume elec efficiency 50%</span>
<span class="c1"># this gets us to p/kWh, then * 10 to get £/MWh</span>
<span class="n">future_result</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Gas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">future_result</span><span class="p">[</span><span class="s1">&#39;Gas carbon tax (p/kWh)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span>
    <span class="n">future_result</span><span class="p">[</span><span class="s1">&#39;Gas price&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">/</span> <span class="mf">14.65</span><span class="p">)</span>
<span class="c1"># coal is in USD per tonne, * 0.75 to get pounds</span>
<span class="c1"># one tonne can create 2.460 MWh electricity, divide by this</span>
<span class="c1"># to get £/MWh</span>
<span class="c1"># also a 1.4 fudge factor to get closer to 2020 price</span>
<span class="n">future_result</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Coal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">future_result</span><span class="p">[</span><span class="s1">&#39;Coal carbon tax (p/kWh)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span>
    <span class="n">future_result</span><span class="p">[</span><span class="s1">&#39;Coal price&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.4</span> <span class="o">*</span> <span class="mf">0.8</span> <span class="o">/</span> <span class="mf">2.460</span><span class="p">)</span>
<span class="c1"># oil is in $ per barrel, so * 0.75 to get pounds</span>
<span class="c1"># 1.7 MWh per barrel thermal, so *0.3 to get 0.85 MWh elec</span>
<span class="c1"># divide by this to get £/MWh</span>
<span class="n">future_result</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Oil&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">future_result</span><span class="p">[</span><span class="s1">&#39;Oil carbon tax (p/kWh)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span>
    <span class="n">future_result</span><span class="p">[</span><span class="s1">&#39;Oil price&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.8</span> <span class="o">/</span> <span class="mf">0.51</span><span class="p">)</span>

<span class="n">marginal_prices2</span> <span class="o">=</span> <span class="n">future_result</span><span class="p">[[</span><span class="s1">&#39;Coal&#39;</span><span class="p">,</span> <span class="s1">&#39;Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;Oil&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">marginal_prices</span> <span class="o">=</span> <span class="n">marginal_prices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">marginal_prices2</span><span class="p">)</span>
<span class="n">marginal_prices</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Coal</th>
      <th>Gas</th>
      <th>Oil</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-01-01 00:00:00</th>
      <td>33.14282</td>
      <td>34.786835</td>
      <td>100.481909</td>
    </tr>
    <tr>
      <th>2010-01-01 00:30:00</th>
      <td>33.14282</td>
      <td>34.786835</td>
      <td>100.481909</td>
    </tr>
    <tr>
      <th>2010-01-01 01:00:00</th>
      <td>33.14282</td>
      <td>34.786835</td>
      <td>100.481909</td>
    </tr>
    <tr>
      <th>2010-01-01 01:30:00</th>
      <td>33.14282</td>
      <td>34.786835</td>
      <td>100.481909</td>
    </tr>
    <tr>
      <th>2010-01-01 02:00:00</th>
      <td>33.14282</td>
      <td>34.786835</td>
      <td>100.481909</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2050-12-31 21:30:00</th>
      <td>219.0824</td>
      <td>147.950862</td>
      <td>219.376874</td>
    </tr>
    <tr>
      <th>2050-12-31 22:00:00</th>
      <td>219.0824</td>
      <td>147.950862</td>
      <td>219.376874</td>
    </tr>
    <tr>
      <th>2050-12-31 22:30:00</th>
      <td>219.0824</td>
      <td>147.950862</td>
      <td>219.376874</td>
    </tr>
    <tr>
      <th>2050-12-31 23:00:00</th>
      <td>219.0824</td>
      <td>147.950862</td>
      <td>219.376874</td>
    </tr>
    <tr>
      <th>2050-12-31 23:30:00</th>
      <td>219.0824</td>
      <td>147.950862</td>
      <td>219.376874</td>
    </tr>
  </tbody>
</table>
<p>718800 rows × 3 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marginal_prices</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Coal price + carbon (£/MWh)&#39;</span><span class="p">,</span> <span class="s1">&#39;Gas price + carbon (£/MWh)&#39;</span><span class="p">,</span> <span class="s1">&#39;Oil price + carbon (£/MWh)&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Coal, gas, and oil future marginal prices based on FES2021&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_3_-_Generator_and_Marginal_Prices_18_0.png" src="../_images/notebooks_3_-_Generator_and_Marginal_Prices_18_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="2%20-%20Demand.html" class="btn btn-neutral float-left" title="Demand" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="4%20-%20Renewable%20Power%20and%20Storage.html" class="btn btn-neutral float-right" title="Renewable Power and Storage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Andrew Lyden.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
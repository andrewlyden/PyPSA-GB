

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Network Expansion &mdash; PyPSA-GB  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Floating Wind &amp; Marine, and Emissions" href="5c%20-%20Floating%20Wind%2C%20Marine%20and%20Emissions%20Modelling.html" />
    <link rel="prev" title="Comparison To Historical Data" href="9%20-%20Comparison%20To%20Historical%20Data.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            PyPSA-GB
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data and Functionality</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="1%20-%20Network.html">Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="1%20-%20Network.html#Zonal-model">Zonal model</a></li>
<li class="toctree-l1"><a class="reference internal" href="2%20-%20Demand.html">Demand</a></li>
<li class="toctree-l1"><a class="reference internal" href="3%20-%20Generator%20and%20Marginal%20Prices.html">Generator and Marginal Prices</a></li>
<li class="toctree-l1"><a class="reference internal" href="4%20-%20Renewable%20Power%20and%20Storage.html">Renewable Power and Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="5a%20-%20Historical%20Years.html">Historical Years</a></li>
<li class="toctree-l1"><a class="reference internal" href="5b%20-%20Future%20Years.html">Future Years</a></li>
<li class="toctree-l1"><a class="reference internal" href="5d%20-%20Zonal%20Network.html">LOPF using the Zonal Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="6%20-%20Unit%20Commitment.html">Unit Commitment</a></li>
<li class="toctree-l1"><a class="reference internal" href="9%20-%20Comparison%20To%20Historical%20Data.html">Comparison To Historical Data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Network Expansion</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Setting-up-simulation">Setting up simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Run-the-optimisation">Run the optimisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Outputs">Outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Line-expansion-results">Line expansion results</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="5c%20-%20Floating%20Wind%2C%20Marine%20and%20Emissions%20Modelling.html">Floating Wind &amp; Marine, and Emissions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Scotland_Curtailment_2035.html">Curtailment in Scotland - 2035</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyPSA-GB</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Network Expansion</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/7 - Network Expansion.nblink.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Network-Expansion">
<h1>Network Expansion<a class="headerlink" href="#Network-Expansion" title="Link to this heading"></a></h1>
<p>PyPSA-GB can also allow for certain parameters to be optimised, which can be useful in planning studies. In this notebook network expansion is explored for the month of June in 2050.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">find_dotenv</span><span class="p">,</span> <span class="n">load_dotenv</span>

<span class="n">load_dotenv</span><span class="p">(</span><span class="n">find_dotenv</span><span class="p">())</span>
<span class="n">src_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PROJECT_SRC&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">src_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pypsa</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>

<span class="kn">import</span> <span class="nn">data_reader_writer</span>
</pre></div>
</div>
</div>
<section id="Setting-up-simulation">
<h2>Setting up simulation<a class="headerlink" href="#Setting-up-simulation" title="Link to this heading"></a></h2>
<p>Set the required inputs for the LOPF: the start, end and year of simulation, and the timestep.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># write csv files for import</span>
<span class="n">start</span> <span class="o">=</span> <span class="s1">&#39;2050-06-01 00:00:00&#39;</span>
<span class="n">end</span> <span class="o">=</span> <span class="s1">&#39;2050-06-30 23:30:00&#39;</span>
<span class="c1"># year of simulation</span>
<span class="n">year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
<span class="c1"># time step as fraction of hour</span>
<span class="n">time_step</span> <span class="o">=</span> <span class="mf">0.5</span>
</pre></div>
</div>
</div>
<p>Choose from one of the National Grid Future Energy Scenarios.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scenario</span> <span class="o">=</span> <span class="s1">&#39;Leading The Way&#39;</span>
<span class="c1"># scenario = &#39;Consumer Transformation&#39;</span>
<span class="c1"># scenario = &#39;System Transformation&#39;</span>
<span class="c1"># scenario = &#39;Steady Progression&#39;</span>
</pre></div>
</div>
</div>
<p>Choose a baseline year (from 2010-2020). The baseline year determines which historical load profile and weather dataset is used for the future year modelled. The National Grid FES modellers used 2012 as their baseline year.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">year_baseline</span> <span class="o">=</span> <span class="mi">2012</span>
</pre></div>
</div>
</div>
<p>data_reader_writer is a script written to read in data from the various sources and write csv files in the format required for populating a PyPSA network object</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_reader_writer</span><span class="o">.</span><span class="n">data_writer</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">time_step</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">demand_dataset</span><span class="o">=</span><span class="s1">&#39;eload&#39;</span><span class="p">,</span> <span class="n">year_baseline</span><span class="o">=</span><span class="n">year_baseline</span><span class="p">,</span>
                               <span class="n">scenario</span><span class="o">=</span><span class="n">scenario</span><span class="p">,</span> <span class="n">FES</span><span class="o">=</span><span class="mi">2022</span><span class="p">,</span> <span class="n">merge_generators</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scale_to_peak</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">networkmodel</span><span class="o">=</span><span class="s1">&#39;Reduced&#39;</span><span class="p">,</span> <span class="n">P2G</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\Users\alyden\Anaconda3\envs\PyPSA-GB\lib\site-packages\pandas\core\arrays\datetimes.py:741: PerformanceWarning: Non-vectorized DateOffset being applied to Series or DatetimeIndex
  warnings.warn(
c:\Users\alyden\Anaconda3\envs\PyPSA-GB\lib\site-packages\pandas\core\indexing.py:1667: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self.obj[key] = value
C:\Users\alyden\OneDrive - University of Edinburgh\Python\PyPSA-GB v0.0.1\PyPSA-GB\interconnectors.py:208: UserWarning: This pattern has match groups. To actually get the groups, use str.extract.
  df_FES = df_FES[~df_FES.Variable.str.contains(&#39;(TWh)&#39;)]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span> <span class="o">=</span> <span class="n">pypsa</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span>

<span class="n">network</span><span class="o">.</span><span class="n">import_from_csv_folder</span><span class="p">(</span><span class="s1">&#39;LOPF_data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING:pypsa.io:
Importing PyPSA from older version of PyPSA than current version.
Please read the release notes at https://pypsa.readthedocs.io/en/latest/release_notes.html
carefully to prepare your network for import.
Currently used PyPSA version [0, 20, 1], imported network file PyPSA version None.

INFO:pypsa.components:Applying weightings to all columns of `snapshot_weightings`
WARNING:pypsa.io:Components Index([&#39;Tidal lagoon Harker&#39;, &#39;Tidal lagoon Penwortham&#39;], dtype=&#39;object&#39;, name=&#39;Generator&#39;) for attribute p_max_pu of Generator are not in main components dataframe generators
INFO:pypsa.io:Imported network LOPF_data has buses, generators, lines, links, loads, storage_units
</pre></div></div>
</div>
<p>Now going to allow the limit of the apparent power to flow through the line to be extendable, and provide a capital cost (cost of extending s_nom by 1 MVA.)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">s_nom_extendable</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">network</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">s_nom_min</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">s_nom</span>
<span class="n">network</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">capital_cost</span> <span class="o">=</span> <span class="mi">1000</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">lines</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bus0</th>
      <th>bus1</th>
      <th>r</th>
      <th>x</th>
      <th>b</th>
      <th>s_nom</th>
      <th>type</th>
      <th>g</th>
      <th>s_nom_extendable</th>
      <th>s_nom_min</th>
      <th>...</th>
      <th>v_ang_min</th>
      <th>v_ang_max</th>
      <th>sub_network</th>
      <th>x_pu</th>
      <th>r_pu</th>
      <th>g_pu</th>
      <th>b_pu</th>
      <th>x_pu_eff</th>
      <th>r_pu_eff</th>
      <th>s_nom_opt</th>
    </tr>
    <tr>
      <th>Line</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Beauly</td>
      <td>Peterhead</td>
      <td>0.01220</td>
      <td>0.02000</td>
      <td>0.0856</td>
      <td>525.0</td>
      <td></td>
      <td>0.0</td>
      <td>True</td>
      <td>525.0</td>
      <td>...</td>
      <td>-inf</td>
      <td>inf</td>
      <td></td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Beauly</td>
      <td>Errochty</td>
      <td>0.00700</td>
      <td>0.15000</td>
      <td>0.0520</td>
      <td>132.0</td>
      <td></td>
      <td>0.0</td>
      <td>True</td>
      <td>132.0</td>
      <td>...</td>
      <td>-inf</td>
      <td>inf</td>
      <td></td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Beauly</td>
      <td>Peterhead</td>
      <td>0.01220</td>
      <td>0.02000</td>
      <td>0.2844</td>
      <td>525.0</td>
      <td></td>
      <td>0.0</td>
      <td>True</td>
      <td>525.0</td>
      <td>...</td>
      <td>-inf</td>
      <td>inf</td>
      <td></td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Beauly</td>
      <td>Errochty</td>
      <td>0.00700</td>
      <td>0.15000</td>
      <td>0.0520</td>
      <td>132.0</td>
      <td></td>
      <td>0.0</td>
      <td>True</td>
      <td>132.0</td>
      <td>...</td>
      <td>-inf</td>
      <td>inf</td>
      <td></td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Peterhead</td>
      <td>Denny/Bonnybridge</td>
      <td>0.00040</td>
      <td>0.06500</td>
      <td>0.4454</td>
      <td>760.0</td>
      <td></td>
      <td>0.0</td>
      <td>True</td>
      <td>760.0</td>
      <td>...</td>
      <td>-inf</td>
      <td>inf</td>
      <td></td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Sellindge</td>
      <td>Kemsley</td>
      <td>0.00020</td>
      <td>0.00503</td>
      <td>0.1797</td>
      <td>3100.0</td>
      <td></td>
      <td>0.0</td>
      <td>True</td>
      <td>3100.0</td>
      <td>...</td>
      <td>-inf</td>
      <td>inf</td>
      <td></td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Lovedean</td>
      <td>Sellindge</td>
      <td>0.00038</td>
      <td>0.00711</td>
      <td>0.2998</td>
      <td>3070.0</td>
      <td></td>
      <td>0.0</td>
      <td>True</td>
      <td>3070.0</td>
      <td>...</td>
      <td>-inf</td>
      <td>inf</td>
      <td></td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>96</th>
      <td>Lovedean</td>
      <td>Sellindge</td>
      <td>0.00038</td>
      <td>0.00711</td>
      <td>0.2998</td>
      <td>3070.0</td>
      <td></td>
      <td>0.0</td>
      <td>True</td>
      <td>3070.0</td>
      <td>...</td>
      <td>-inf</td>
      <td>inf</td>
      <td></td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>97</th>
      <td>S.W.Penisula</td>
      <td>Lovedean</td>
      <td>0.00051</td>
      <td>0.00796</td>
      <td>0.3400</td>
      <td>2780.0</td>
      <td></td>
      <td>0.0</td>
      <td>True</td>
      <td>2780.0</td>
      <td>...</td>
      <td>-inf</td>
      <td>inf</td>
      <td></td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>98</th>
      <td>S.W.Penisula</td>
      <td>Lovedean</td>
      <td>0.00051</td>
      <td>0.00796</td>
      <td>0.3400</td>
      <td>2780.0</td>
      <td></td>
      <td>0.0</td>
      <td>True</td>
      <td>2780.0</td>
      <td>...</td>
      <td>-inf</td>
      <td>inf</td>
      <td></td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>99 rows × 29 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">generators</span><span class="o">.</span><span class="n">marginal_cost</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generator
West Burton                    NaN
Sutton Bridge CCS Gas        100.0
Baglan Bay CCS Gas           100.0
Severn Power CCS Gas         100.0
Blackburn CCS Gas            100.0
                             ...
Tidal stream Beauly           -1.0
Tidal stream Neilston         -1.0
Tidal stream S.W.Penisula     -1.0
Wave power Beauly             -1.0
Wave power Melksham           -1.0
Name: marginal_cost, Length: 432, dtype: float64
</pre></div></div>
</div>
</section>
<section id="Run-the-optimisation">
<h2>Run the optimisation<a class="headerlink" href="#Run-the-optimisation" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">solver_name</span><span class="o">=</span><span class="s2">&quot;gurobi&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:pypsa.linopf:Prepare linear problem
INFO:pypsa.linopf:Total preparation time: 13.12s
INFO:pypsa.linopf:Solve linear problem using Gurobi solver
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Set parameter Username
Academic license - for non-commercial use only - expires 2023-10-19
Read LP format model from file C:\Users\alyden\AppData\Local\Temp\pypsa-problem-2w0b5ny_.lp
Reading time = 9.34 seconds
obj: 4180896 rows, 1303300 columns, 7621512 nonzeros
Gurobi Optimizer version 9.5.2 build v9.5.2rc0 (win64)
Thread count: 4 physical cores, 8 logical processors, using up to 8 threads
Optimize a model with 4180896 rows, 1303300 columns and 7621512 nonzeros
Model fingerprint: 0x3952ad20
Coefficient statistics:
  Matrix range     [6e-05, 1e+00]
  Objective range  [5e-01, 5e+08]
  Bounds range     [1e+02, 2e+08]
  RHS range        [1e-06, 8e+12]
Warning: Model contains large rhs
         Consider reformulating model or setting NumericFocus parameter
         to avoid numerical issues.

Concurrent LP optimizer: dual simplex and barrier
Showing barrier log only...

Presolve removed 3666822 rows and 524449 columns
Presolve time: 4.15s
Presolved: 514074 rows, 787485 columns, 2215734 nonzeros

Ordering time: 5.03s

Barrier statistics:
 Dense cols : 99
 Free vars  : 46080
 AA&#39; NZ     : 4.475e+06
 Factor NZ  : 2.937e+07 (roughly 800 MB of memory)
 Factor Ops : 7.891e+09 (less than 1 second per iteration)
 Threads    : 3

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0   1.84320129e+24 -6.25895066e+25  8.00e+10 1.42e+09  7.92e+19    11s
   1   1.74849151e+24 -3.15130292e+25  7.59e+10 1.37e+09  7.55e+19    12s
   2   1.35168121e+24 -1.58892638e+25  5.88e+10 1.07e+09  5.92e+19    13s
   3   8.68452050e+23 -7.89681238e+24  3.78e+10 5.94e+08  3.50e+19    14s
   4   5.81631682e+23 -2.48600064e+24  2.52e+10 1.70e+08  2.23e+19    15s
   5   3.38805060e+23 -6.65187157e+23  1.45e+10 5.49e+07  1.25e+19    15s
   6   1.29289790e+23 -1.46172020e+23  5.22e+09 1.33e+07  4.58e+18    16s
   7   1.45037746e+22 -4.14431265e+22  3.43e+08 3.92e+05  3.27e+17    17s
   8   3.20057076e+21 -6.12409549e+21  3.97e+07 2.15e+04  3.93e+16    18s
   9   1.30530767e+20 -3.10187637e+20  1.14e+06 4.72e+03  1.24e+15    19s
  10   3.28812651e+18 -1.36617258e+18  2.81e+04 6.62e+00  2.67e+13    19s
  11   1.84320129e+24 -6.25895066e+25  8.00e+10 1.42e+09  7.92e+19    21s
  12   1.90548952e+24 -5.75813921e+25  7.29e+10 1.30e+09  1.67e+20    22s
  13   1.60202159e+24 -4.09233764e+25  5.95e+10 1.00e+09  2.65e+20    23s
  14   8.71135819e+23 -1.64472183e+25  3.21e+10 3.75e+08  2.44e+20    24s
  15   2.49278894e+23 -3.02100483e+24  8.90e+09 6.86e+07  7.54e+19    25s
  16   5.16716344e+22 -7.22938874e+23  1.54e+09 1.65e+07  1.25e+19    26s
  17   1.93700411e+22 -2.31192385e+23  3.79e+08 5.41e+06  2.41e+18    26s
  18   5.62446296e+21 -3.68966111e+22  7.97e+07 9.27e+05  4.68e+17    27s
  19   4.44105118e+20 -2.91922045e+21  6.53e+06 7.74e+04  4.13e+16    28s
  20   2.02967756e+18 -6.84690575e+18  2.95e+04 1.81e+02  1.74e+14    29s
  21   5.88850815e+17 -1.89881290e+18  8.84e+03 4.97e+01  2.18e+13    30s
  22   8.72767344e+16 -4.65788280e+17  1.61e+03 1.17e+01  1.56e+12    31s
  23   2.08820084e+16 -1.77922695e+17  4.69e+02 4.43e+00  2.92e+11    32s
  24   2.93700680e+15 -5.11893245e+16  7.24e+01 1.36e+00  4.33e+10    33s
  25   7.46677703e+14 -3.99796194e+15  5.15e+00 1.22e-01  2.87e+09    34s
  26   1.19114653e+13 -4.22430270e+13  1.15e-01 1.54e-03  3.07e+07    35s
  27   9.87593035e+09 -2.90583931e+11  5.99e-04 3.85e-05  1.70e+05    36s
  28   5.33812294e+09 -7.89348485e+10  1.05e-04 2.36e-05  4.77e+04    37s
  29   2.15292085e+09 -2.19272815e+10  2.23e-05 8.07e-06  1.36e+04    39s
  30   1.69058287e+09 -1.03950855e+10  1.69e-05 4.32e-06  6.84e+03    40s
  31   1.28558269e+09 -4.22410552e+09  1.27e-05 3.21e-06  3.12e+03    42s
  32   7.90330561e+08 -2.12781675e+09  8.05e-06 1.94e-06  1.65e+03    44s
  33   4.90232503e+08 -1.20002040e+09  5.20e-06 2.31e-06  9.56e+02    47s
  34   3.91533674e+08 -9.05153093e+08  4.21e-06 1.73e-06  7.33e+02    49s
  35   3.35022030e+08 -7.06468664e+08  3.64e-06 2.24e-06  5.89e+02    52s
  36   2.86243963e+08 -5.89751542e+08  3.12e-06 2.10e-06  4.96e+02    53s
  37   2.62726953e+08 -5.14325913e+08  2.87e-06 3.53e-06  4.40e+02    56s
  38   2.38931165e+08 -4.30915403e+08  2.61e-06 3.84e-06  3.79e+02    58s
  39   1.53899406e+08 -3.01795602e+08  1.70e-06 2.86e-06  2.58e+02    61s
  40   1.18578679e+08 -2.28393180e+08  1.33e-06 3.27e-06  1.96e+02    64s
  41   9.58197639e+07 -1.83201027e+08  1.08e-06 2.88e-06  1.58e+02    67s
  42   8.48979107e+07 -1.14209436e+08  9.53e-07 3.32e-06  1.13e+02    69s
  43   6.83030721e+07 -9.48856775e+07  7.67e-07 3.13e-06  9.23e+01    71s
  44   5.66380557e+07 -8.04563294e+07  6.37e-07 3.01e-06  7.75e+01    73s
  45   4.34579936e+07 -6.38972410e+07  4.92e-07 2.87e-06  6.07e+01    75s
  46   3.43083729e+07 -5.28995116e+07  3.83e-07 1.66e-06  4.93e+01    78s
  47   2.64506602e+07 -3.18356159e+07  2.94e-07 2.55e-06  3.30e+01    80s
  48   2.11188199e+07 -2.27146208e+07  2.34e-07 3.55e-06  2.48e+01    82s
  49   1.88919868e+07 -2.01730941e+07  2.08e-07 4.63e-06  2.21e+01    85s
  50   1.61783287e+07 -1.59503240e+07  1.77e-07 3.50e-06  1.82e+01    87s
  51   1.41242858e+07 -1.30547863e+07  1.53e-07 4.57e-06  1.54e+01    89s
  52   1.10313470e+07 -1.12281224e+07  1.16e-07 4.60e-06  1.26e+01    91s
  53   9.99966908e+06 -9.09558993e+06  1.04e-07 3.47e-06  1.08e+01    93s
  54   8.95870726e+06 -7.47114466e+06  9.26e-08 4.59e-06  9.29e+00    96s
  55   8.60702480e+06 -6.37984284e+06  8.82e-08 3.46e-06  8.48e+00    98s
  56   7.47982669e+06 -4.61528174e+06  7.45e-08 4.58e-06  6.84e+00   100s
  57   6.11990396e+06 -3.49596159e+06  5.80e-08 3.45e-06  5.44e+00   103s
  58   5.43328786e+06 -2.75426742e+06  4.97e-08 3.46e-06  4.63e+00   105s
  59   5.15797860e+06 -2.26931289e+06  4.64e-08 3.44e-06  4.20e+00   107s
  60   4.63058321e+06 -1.33195638e+06  4.03e-08 4.58e-06  3.37e+00   109s
  61   4.25941647e+06 -8.49627862e+05  3.58e-08 3.45e-06  2.89e+00   112s
  62   4.00797283e+06 -6.85732100e+05  3.27e-08 3.45e-06  2.66e+00   115s
  63   3.60529356e+06 -1.62965680e+05  2.80e-08 3.46e-06  2.13e+00   118s
  64   3.46612972e+06 -4.93762167e+04  2.64e-08 3.48e-06  1.99e+00   120s
  65   3.25475916e+06  2.05833315e+05  2.38e-08 3.46e-06  1.72e+00   123s
  66   3.13954313e+06  3.10738993e+05  2.24e-08 2.32e-06  1.60e+00   126s
  67   2.72009970e+06  5.28433892e+05  1.73e-08 2.36e-06  1.24e+00   129s
  68   2.53175920e+06  6.92588466e+05  1.51e-08 2.39e-06  1.04e+00   132s
  69   2.30367828e+06  7.71789508e+05  1.22e-08 1.21e-06  8.67e-01   135s
  70   2.18869192e+06  8.79002370e+05  1.08e-08 2.43e-06  7.41e-01   137s
  71   2.07377575e+06  9.60891447e+05  9.36e-09 2.43e-06  6.30e-01   140s
  72   1.91302807e+06  1.02782549e+06  7.28e-09 2.46e-06  5.01e-01   144s
  73   1.81950834e+06  1.08715536e+06  6.12e-09 2.49e-06  4.14e-01   147s
  74   1.74175349e+06  1.13787477e+06  5.09e-09 1.25e-06  3.42e-01   150s
  75   1.67185754e+06  1.19568394e+06  4.17e-09 1.50e-06  2.69e-01   153s
  76   1.62132940e+06  1.24857330e+06  3.50e-09 1.25e-06  2.11e-01   156s
  77   1.54084946e+06  1.27560329e+06  2.42e-09 2.58e-06  1.50e-01   159s
  78   1.49486282e+06  1.29957536e+06  1.77e-09 5.80e-06  1.10e-01   162s
  79   1.45572189e+06  1.31896604e+06  1.21e-09 4.20e-06  7.74e-02   165s
  80   1.43814712e+06  1.33713595e+06  9.55e-10 2.78e-06  5.71e-02   168s
  81   1.42238516e+06  1.34705001e+06  7.24e-10 2.49e-06  4.26e-02   171s
  82   1.41023293e+06  1.35533251e+06  5.49e-10 3.59e-06  3.11e-02   174s
  83   1.40190245e+06  1.36161841e+06  4.21e-10 2.65e-06  2.28e-02   177s
  84   1.39241575e+06  1.36674761e+06  2.75e-10 2.04e-06  1.45e-02   180s
  85   1.38688382e+06  1.36921698e+06  2.44e-09 2.23e-06  9.99e-03   183s
  86   1.38353556e+06  1.37088555e+06  1.98e-09 2.68e-06  7.16e-03   187s
  87   1.38167967e+06  1.37177010e+06  5.09e-09 2.67e-06  5.61e-03   190s
  88   1.38020383e+06  1.37213029e+06  7.68e-09 2.64e-06  4.57e-03   192s
  89   1.37981630e+06  1.37267491e+06  6.82e-09 3.96e-06  4.04e-03   194s
  90   1.37849818e+06  1.37364723e+06  6.13e-09 3.95e-06  2.74e-03   197s
  91   1.37731002e+06  1.37420690e+06  6.18e-09 3.94e-06  1.76e-03   200s
  92   1.37683081e+06  1.37463994e+06  2.20e-08 3.92e-06  1.24e-03   203s
  93   1.37609122e+06  1.37485104e+06  4.03e-08 2.66e-06  7.02e-04   206s
  94   1.37583516e+06  1.37500937e+06  8.53e-08 2.68e-06  4.67e-04   208s
  95   1.37573407e+06  1.37507695e+06  7.10e-08 2.68e-06  3.72e-04   210s
  96   1.37565069e+06  1.37511363e+06  5.85e-08 4.02e-06  3.04e-04   212s
  97   1.37560010e+06  1.37513075e+06  5.04e-08 2.68e-06  2.65e-04   215s
  98   1.37542304e+06  1.37518114e+06  1.83e-07 2.63e-06  1.37e-04   217s
  99   1.37536080e+06  1.37522098e+06  1.40e-07 3.92e-06  7.91e-05   219s
 100   1.37529993e+06  1.37524113e+06  5.87e-08 4.57e-06  3.33e-05   222s
 101   1.37527892e+06  1.37524949e+06  1.48e-07 4.60e-06  1.67e-05   224s
 102   1.37527286e+06  1.37525284e+06  1.49e-07 7.72e-06  1.14e-05   226s
 103   1.37526803e+06  1.37525638e+06  2.44e-07 1.47e-05  6.65e-06   228s
 104   1.37526552e+06  1.37526027e+06  1.75e-07 1.75e-05  3.00e-06   229s
 105   1.37526394e+06  1.37526181e+06  1.29e-06 2.42e-05  1.31e-06   231s
 106   1.37526329e+06  1.37526228e+06  1.24e-06 1.17e-05  6.30e-07   232s
 107   1.37526313e+06  1.37526248e+06  8.52e-07 1.05e-05  4.09e-07   234s

Barrier solved model in 107 iterations and 233.91 seconds (165.16 work units)
Optimal objective 1.37526313e+06

Crossover log...

   30552 DPushes remaining with DInf 0.0000000e+00               235s
    7104 DPushes remaining with DInf 0.0000000e+00               240s
    1950 DPushes remaining with DInf 0.0000000e+00               246s
      61 DPushes remaining with DInf 0.0000000e+00               251s
       0 DPushes remaining with DInf 0.0000000e+00               251s

  223684 PPushes remaining with PInf 2.3016161e-03               251s
  155562 PPushes remaining with PInf 8.2543796e-03               259s
  129913 PPushes remaining with PInf 9.2381003e-03               261s
   93021 PPushes remaining with PInf 5.4683447e-03               266s
   75512 PPushes remaining with PInf 4.3640087e-03               270s
   64396 PPushes remaining with PInf 3.8051466e-03               275s
   41107 PPushes remaining with PInf 2.1092109e-03               280s
   23819 PPushes remaining with PInf 1.5961399e-03               285s
   13200 PPushes remaining with PInf 7.2135621e-04               290s
    6791 PPushes remaining with PInf 0.0000000e+00               295s
       0 PPushes remaining with PInf 0.0000000e+00               300s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.5302532e+01    300s

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  253949    1.3752628e+06   0.000000e+00   1.530253e+01    300s
  254053    1.3752628e+06   0.000000e+00   0.000000e+00    303s

Solved with barrier
Solved in 254053 iterations and 302.55 seconds (255.10 work units)
Optimal objective  1.375262781e+06
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:pypsa.linopf:Optimization successful. Objective value: 1.38e+06
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&#39;ok&#39;, &#39;optimal&#39;)
</pre></div></div>
</div>
</section>
<section id="Outputs">
<h2>Outputs<a class="headerlink" href="#Outputs" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">now</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="mi">139</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;With the linear load flow, there is the following per unit loading:&quot;</span><span class="p">)</span>
<span class="n">loading</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">lines_t</span><span class="o">.</span><span class="n">p0</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">/</span> <span class="n">network</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">s_nom</span>
<span class="n">loading</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
With the linear load flow, there is the following per unit loading:
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
count    99.000000
mean      0.205377
std       0.700158
min      -1.835611
25%      -0.127628
50%       0.169721
75%       0.386551
max       2.976289
dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()})</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span>

<span class="n">network</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">line_colors</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">loading</span><span class="p">),</span> <span class="n">line_cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Line loading&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&lt;matplotlib.collections.PatchCollection at 0x1b5146b1490&gt;,
 &lt;matplotlib.collections.LineCollection at 0x1b514e7c820&gt;,
 &lt;matplotlib.collections.LineCollection at 0x1b514e7c3a0&gt;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_7_-_Network_Expansion_22_1.png" src="../_images/notebooks_7_-_Network_Expansion_22_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()})</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">network</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">line_widths</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">network</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hexbin</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">buses</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">network</span><span class="o">.</span><span class="n">buses</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
           <span class="n">gridsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
           <span class="n">C</span><span class="o">=</span><span class="n">network</span><span class="o">.</span><span class="n">buses_t</span><span class="o">.</span><span class="n">marginal_price</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">now</span><span class="p">],</span>
           <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">)</span>

<span class="c1"># for some reason the colorbar only works with graphs plt.plot</span>
<span class="c1"># and must be attached plt.colorbar</span>

<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Locational Marginal Price (£/MWh)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_7_-_Network_Expansion_23_0.png" src="../_images/notebooks_7_-_Network_Expansion_23_0.png" />
</div>
</div>
</section>
<section id="Line-expansion-results">
<h2>Line expansion results<a class="headerlink" href="#Line-expansion-results" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">network</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">s_nom_opt</span>
<span class="n">difference</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">s_nom_opt</span> <span class="o">-</span> <span class="n">network</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">s_nom</span>
<span class="n">relative_difference</span> <span class="o">=</span> <span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">s_nom_opt</span> <span class="o">-</span> <span class="n">network</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">s_nom</span><span class="p">)</span> <span class="o">/</span> <span class="n">network</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">s_nom</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>

<span class="n">difference</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Line expansion&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;MVA&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Line&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0, &#39;Line&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_7_-_Network_Expansion_26_1.png" src="../_images/notebooks_7_-_Network_Expansion_26_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">})</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>

<span class="n">relative_difference</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Relative line expansion&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Lines 0 to 99&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0, &#39;Lines 0 to 99&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_7_-_Network_Expansion_27_1.png" src="../_images/notebooks_7_-_Network_Expansion_27_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="9%20-%20Comparison%20To%20Historical%20Data.html" class="btn btn-neutral float-left" title="Comparison To Historical Data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="5c%20-%20Floating%20Wind%2C%20Marine%20and%20Emissions%20Modelling.html" class="btn btn-neutral float-right" title="Floating Wind &amp; Marine, and Emissions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Andrew Lyden.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>